<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title>Ito 公式求解</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>



<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



</head>

<body>
<hr/>

<p>layout:   post
title:    &ldquo;庖丁解牛之 Ito 公式&rdquo;
category: 金融数学 
tags:     </p>

<ul>
<li>Ito</li>
<li>股票</li>
<li>价格
description: 
published: false
status:    process
&mdash;</li>
</ul>

<p>假设股票价格的变化服从以下运动方程（随机微分方程，SDE）：
\[ 
\begin{align}
 d S_t = \mu S_t dt + \sigma S_t dW_t,
\end{align}
 \]
其中 \( dW_t \) 是一个（连续的）<strong>Brownian motion</strong>，\( W_t \sim \mathcal{N} (0, t) \)。等价的，我们可以得到股票价格变化率：
\[ 
\begin{align}
 d \ln S_t = \frac{ d S_t }{ S_t } = \mu dt + \sigma dW_t.
\end{align}
 \]</p>

<p>下面我们来推到股票价格 \( S_t \) 的动态方程，这主要是使用著名的 <strong>Ito 公式</strong>。过于理论的东西我在这里不推导了，主要是利用一个简单的例子来说明如何使用 <strong>Ito 公式</strong> 解 <strong>SDE</strong> 类问题。</p>

<!-- more -->

<h2>Ito 公式求解</h2>

<p>首先，令 \( Y_t = ln S_t \)，由简单的偏微分求导得到
\[ 
\begin{align}
\frac{ \partial Y }{ \partial t} &= 0 \\
\frac{ \partial Y }{ \partial S} &= \frac{ 1 }{ S } \\
\frac{ \partial^2 Y }{ \partial S^2} &= - \frac{ 1 }{ S^2 } \\
\end{align}
 \]
则根据 <strong>Ito 公式</strong>，我们可以推出以下方程
\[ 
\begin{align}
 d \ln S_t = d Y_t 
  &= \frac{ \partial Y }{ \partial t} dt + \frac{ \partial Y }{ \partial S} dS_t + \frac{1}{2} \frac{ \partial^2 Y }{ \partial S^2} dS_t dS_t \\
  &= 0 · dt + \frac{ 1 }{ S_t } dS_t - \frac{1}{2} · \frac{ 1 }{ S_t^2 } dS_t dS_t \\
  &=  \frac{ 1 }{ S_t } · S_t · (\mu dt + \sigma dW_t) - \frac{1}{2} · \frac{ 1 }{ S_t^2 } · \sigma^2 S_t^2 dt
 \\
  &= (\mu - \frac{1}{2} \sigma^2) dt + \sigma dW_t. \\
\end{align}
 \]
两边求积分，得到如下式子
\[ 
\begin{align}
 \int_{0}^{t} d \ln S_u = \int_{0}^{t} d Y_u 
    &= \int_{0}^{t}  (\mu - \frac{1}{2} \sigma^2) du + \int_{0}^{t}  \sigma dW_u \\
\Rightarrow \ln S_t - \ln S_0 = Y_t - Y_0 &= (\mu - \frac{1}{2} \sigma^2) t + \int_{0}^{t}  \sigma dW_u.
\end{align}
 \]
我们知道，<strong>Brownian Motion</strong> 表示在一定时间段内随机游走走过的路径，并且如果我们假定在初始阶段为 \( W(0)=0 \)，那么，上面等式的最后一项是
\[ 
\begin{align}
\int_{0}^{t}  \sigma dW_u &= \sigma (W_t - W_0 ) = \sigma W_t.
\end{align}
 \]</p>

<p>因此，我们有
\[ 
\begin{align}
 \ln S_t - \ln S_0 = Y_t - Y_0 &= (\mu - \frac{1}{2} \sigma^2) t + \sigma W_t \\
  \Rightarrow Y_t &= Y_0 + (\mu - \frac{1}{2} \sigma^2) t + \sigma W_t \\
 \Rightarrow S_t &= S_0 · \exp\{  (\mu - \frac{1}{2} \sigma^2) t + \sigma W_t  \}.
\end{align}
 \]</p>

<h2>几何布朗运动</h2>

<p>我们知道，对于任何一个正态分布做线性转换后依然服从正态分布。由于布朗运动 \( W_t \sim \mathcal{N} (0, t) \)，则
\[ 
\begin{align}
  Y_t &= Y_0 + (\mu - \frac{1}{2} \sigma^2) t + \sigma W_t \\
\Rightarrow E[Y_t|Y_0] &= E[ Y_0 + (\mu - \frac{1}{2} \sigma^2) t + \sigma W_t] \\
                       &= Y_0 + (\mu - \frac{1}{2} \sigma^2) t + \underbrace{E[\sigma W_t]}_{0} = Y_0 + (\mu - \frac{1}{2} \sigma^2) t \\
\Rightarrow Var[Y_t|Y_0] &= Var [\sigma W_t] = \sigma^2 Var(Wt) = \sigma^2 ·t \\
\Rightarrow Y_t &\sim \mathcal{N}(  Y_0 + (\mu - \frac{1}{2} \sigma^2) t, \sigma^2 t  ) \label{gbm_norm}
\end{align} 
 \]</p>

<p>那么，\( \ln S_t = Y_t \) 则服从 <strong>正态分布</strong>，则 \( S_t = e^{Y_t} \)服从 *log-normal disctribution*，即 \( \ln S_t \sim \mathcal{N} (E[S_t], Var[S_t]) \).</p>

<p>下面我们来推导 \( S_t \) 的分布特征。</p>

<h3>Moment Generation Function</h3>

<p>我们知道，对于对任何一个随机变量建模，往往需要假设该变量服从某一类随机过程，而这个随机过程由分布函数（distribution function）给定。可是，有些时候，我们并不一定需要知道整个分布函数的具体形式，而只是关注该随机变量的几个「统计特征」，如一阶矩、二阶矩等。下面要介绍的「矩条件生成函数」就针对这种情况提出的。随机变量的矩条件可以在 <strong>Moment Generation Function</strong> (MGF) 十分方便的推导出来。比如，对于正态分布，我们只需要知道一阶矩和二阶矩条件就可以对变量做统计推断（method of moment, MM，还有更一般的 GMM）。</p>

<p>对于一个<strong>可测空间</strong> \( (\Omega, \mathcal{F}, P) \)，随机变量 \( X \in \sigma(\mathcal{F}) \) 的 MGF 定义为
\[ 
\begin{align}
 M_{X}(\tau) &= E[ e^{x\tau}] = \int_{\Omega} e^{x(\omega)\tau} dP(\omega)
\end{align}
 \]
其任一 \( m- \) 阶的矩公式可以对 \( \tau \) 在 \( \tau = 0 \) 处求 \( m \) 次导数得到
\[ 
\begin{align}
  \frac{\partial M_{X}(\tau)}{\partial \tau}|_{\tau = 0} 
  &=   \frac{\partial}{\partial \tau} E[ e^{x\tau}] |_{\tau = 0}  
  =  E[ x · e^{x\tau}] |_{\tau = 0}    \\
  &= E[x] \\
   \frac{\partial ^2 M_{X}(\tau)}{\partial \tau ^2 }|_{\tau = 0} 
 &= E[x^2] \\
 \frac{\partial ^m M_{X}(\tau)}{\partial \tau ^m }|_{\tau = 0} 
 &= E[x^m]
\end{align}
 \]
特别的，对于一个正态分布，\( X \sim \mathcal{N}(\mu, \sigma^2) \)，有
\[ 
\begin{align}
  M_{X}(\tau) &= E[ e^{x\tau}] = \exp\{ \mu \tau + \frac{1}{2} \sigma^2 \tau^2 \}
\end{align} \\
 \]</p>

<h3>期望与方差</h3>

<p>这个特征对于求一个「对数正态分布」十分有用。由\( \ref{gbm_norm} \)
\[ 
\begin{align}
  Y_t &\sim \mathcal{N}(  Y_0 + (\mu - \frac{1}{2} \sigma^2) t, \sigma^2 t  ) 
\end{align}
 \]
则其 MGF 为
\[ 
\begin{align}
 M_{Y}(\tau) &= E[e^{y\tau}] = \exp\{ \tilde{\mu} \tau + \frac{1}{2} \tilde{\sigma}^2 \tau^2 \},
\end{align}
 \]
其中，\( \tilde{\mu} = Y_0 + (\mu - \frac{1}{2} \sigma^2) t \)，\( \tilde{\sigma}^2= \sigma ^2 t \) .</p>

<p>因此，我们可以得到如下公式
\[ 
\boxed{
 \begin{align}
  E[S^{\tau}] &=  E[e^{y\tau}]  = \exp\{ \tilde{\mu} \tau + \frac{1}{2} \tilde{\sigma}^2 \tau^2 \}
 \end{align}
}
 \]</p>

<p>即，期望可以表示为
\[ 
\boxed{
 \begin{align}
  E[S_t] &=  E[e^{y\tau}]|_{\tau = 1}  = \exp\{ \tilde{\mu}  + \frac{1}{2} \tilde{\sigma}^2  \}  \\
        &= \exp\{ Y_0 + (\mu - \frac{1}{2} \sigma^2) t + \frac{1}{2} \sigma^2 t  \} \\
        &= S_0 · e^{\mu t } \\
\end{align}
}
 \]</p>

<p>\[ 
\boxed{
 \begin{align}
  E[S^2] &= E[e^{y\tau}]|_{\tau = 2}  = \exp\{ 2 \tilde{\mu}  + 2 \tilde{\sigma}^2  \} \\
  &= \exp\{ 2 [Y_0 + (\mu - \frac{1}{2} \sigma^2) t ] + 2 \sigma^2 t \}   \\
  &= S_0^2 · \exp\{ 2 \mu t + \sigma^2 t\}
 \end{align}
}
 \]</p>

<p>因此，\( S_t \) 的方差可以表示为
\[ 
\boxed{
 \begin{align}
  Var[S_t] 
  &=   E[S^2] -  ( E[S] )^2 \\
  &= S_0^2 · \exp\{ 2 \mu t + \sigma^2 t\} - S_0^2 · \exp\{ 2 \mu t \} \\
  &= S_0^2 · e^{ 2 \mu t } · (e^{ \sigma^2 t - 1 })
 \end{align}
}
 \]</p>

</body>

</html>

