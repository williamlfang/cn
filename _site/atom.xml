<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[雁起平沙的网络日志]]></title>
  <link href="http://yanping.me/cn/atom.xml" rel="self"/>
  <link href="http://yanping.me/cn/"/>
  <updated>2013-10-24T00:33:41+08:00</updated>
  <id>http://yanping.me/cn/</id>
  <author>
    <name><![CDATA[ypchen]]></name>
    <email><![CDATA[chen@yanping.me]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[关于Github Pages 视频教程]]></title>
    <link href="http://yanping.me/cn/blog/2013/08/12/about-github-pages-step-by-step-video/"/>
    <updated>2013-08-12T23:30:00+08:00</updated>
    <id>http://yanping.me/cn/blog/2013/08/12/about-github-pages-step-by-step-video</id>
    <content type="html"><![CDATA[<p>昨天我发布了《github pages视频教程（1）》，今晚就有童鞋留言反馈，提得很好，对我今后再录视频有很大的促进。同时，我也觉得有必要解释些几点，免得大家产生误解。</p>

<h3 id="section">一、我为什么要录这个视频</h3>

<p>没什么特别原因，就是有几位朋友用github做博客出了点问题，我就说，那我录个视频吧。然后一想，光是你们几个能看到视频还不行，估计还有很多朋友会遇到这些问题，那我就公开吧。</p>

<h3 id="github">二、什么是github？它能做什么？</h3>

<p>推荐大家阅读阳志平老师的<a href="www.yangzhiping.com/tech/github.html">如何高效利用GitHub</a></p>

<h3 id="github-1">三、为什么要用github做博客</h3>

<p>首先，准确地说，应该是用github托管博客。你注册github以后，它提供了这样一种机制，你可以在github上存放静态网站（纯html+css+js）的代码，然后，你可以通过访问一定的url地址来访问网站。而jekyll是一种基于ruby语言的轻量级静态网站生成引擎，请看我以前翻译的一篇<a href="http://yanping.me/cn/blog/2011/12/15/building-static-sites-with-jekyll/">介绍</a>。github的后台还提供jekyll的程序的服务，这样，你把未编译的jekyll博客代码push到github上，它会在后台帮你编译，你也可以本地编译之后再push。听不懂没关系，以后会讲的。</p>

<p>那为什么要用github呢？这纯粹是个人喜好问题，2011年底，我想开个博客，那时候统计之都的几位博主都是wordpress的博客，我也用了几天，然后谢益辉在邮件里提到用github能搭博客，我就研究了好几个星期，完全上瘾了。你可以看看益辉当时写的一篇<a href="http://yihui.name/cn/2011/10/back-into-the-dust/">博文</a>，阐述他为什么要换到jekyll。阳志平老师也有一篇<a href="http://www.yangzhiping.com/tech/wordpress-to-jekyll.html">告别wordpress，拥抱jekyll</a>，去网上搜一下，你会发现，叫这个名字的文章还真不少。</p>

<h3 id="github-pages">四、什么人适合用github pages</h3>

<p>我并没有向大家推销github和jekyll的意思，这套东西真的不适合所有人。如果你跟我一样是代码控、经常用github存放代码、觉得wordpress不灵活、想通过实践学习html/css/js，那么你可以试试用github托管博客。</p>

<p>两年以前，我跟大家一样，不会做网页，不懂html/css/js，之后偶尔学一点，在用中学，现在也能做出像点样子的网站了。</p>

<h3 id="jekyll">五、为什么用jekyll做的网站好看的不多？</h3>

<p>这是个天大的误解，网站好不好看，跟你用什么系统没关系，而是跟你的html/css/js有关，你可以把jekyll当作cms，网站样子好不好看，就要看你的设计了。很多用jekyll做博客的孩子都是程序猿，崇尚简洁，而且不会把大量时间花在设计上，也有网站设得很好的，比如 <a href="http://pizn.github.io">http://pizn.github.io</a> 。如果你能找到一个设计得很好的页面，完全可以用jekyll来做博客，当然，你也可以用wordpress做，跟系统没关系。</p>

<p>在第一期视频里，我举的那个例子用的是jekyll自带的最简单的模板，虽然很难看，但是它很简单，而且该有的都有了。在讲解的时候，我可以迅速定位到关键的代码，排除那些枝枝蔓蔓的影响。</p>

<h3 id="section-1">六、之后的视频教程会有什么？</h3>

<p>视频课程的第一次只是讲了基本概念，教你如何把别人的网站clone到自己的github里，还没有讲如何做一个属于自己的博客主题。这将是后面课程的重点。我先从修改别人的网站代码讲起吧。</p>

<h3 id="section-2">七、这个课不会教什么？</h3>

<p>我们这个课是关于github pages和jekyll的，不会教html/css/js，你需要自己去学，下面有些资源</p>

<ul>
  <li><a href="http://www.w3school.com.cn/">W3schol</a></li>
  <li><a href="http://zixue.it">自学it网</a></li>
  <li><a href="http://wenku.baidu.com/course/list/5">百度文库课程</a></li>
</ul>

<p>当然，网上还有很多资源，不限于上面的，不过我觉得，更重要的是在实践中学习。</p>

<h3 id="section-3">八、不足之处</h3>

<p>第一次录视频，不太熟练，有点紧张，错了就要重来，可是，我发现越是紧张，就越会出错，那天从下午三点一直录到晚上八点，最终还是三段视频拼到一起的，重来一遍的代价太高了。我觉得应该分段录的，十几分钟一段。</p>

<p>另外，我的确应该重新注册个空白帐号的，我帐号里的东西太多，会分散大家注意力。下次我会用新帐号把这次视频的后半部分重讲一遍。</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Github Pages 视频教程（1）]]></title>
    <link href="http://yanping.me/cn/blog/2013/08/11/github-pages-step-by-step-video/"/>
    <updated>2013-08-11T10:30:00+08:00</updated>
    <id>http://yanping.me/cn/blog/2013/08/11/github-pages-step-by-step-video</id>
    <content type="html"><![CDATA[<p class="info">去年我写了一篇<a href="http://yanping.me/cn/blog/2012/03/18/github-pages-step-by-step/">《Github Pages极简教程》</a>，一年过去了，很多童鞋反映说在实际操作中遇到了这样那样的问题，而且github页面也改版了，jekyll也升级了，情况和当初有所不同。所以我就录了这个系列的视频，希望能对大家有所帮助。</p>

<div>
<embed src="http://static.youku.com/v/swf/qplayer.swf?winType=adshow&amp;VideoIDS=XNTk0MjYxODQ0&amp;isAutoPlay=false&amp;isShowRelatedVideo=false" wmode="transparent" width="620" align="center" border="0" height="510" />
</div>

<div style="padding-top:20px;padding-bottom:20px;line-height:25px">
      <strong><a href="http://yanping.me/cn/blog/2013/08/11/github-pages-step-by-step-video/">Github Pages 视频教程（1）</a></strong><br />
            长度: 49 分 58 秒<br />
            录制: 陈堰平<br />
            <a href="http://v.youku.com/v_show/id_XNTk0MjYxODQ0.html" target="_blank">优酷播放</a> <br />
下载: <a href="http://pan.baidu.com/share/link?shareid=3678776452&amp;uk=3288617424" target="_blank">高清视频文件</a>　





</div>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[【广告】上海北京两地的R语言培训]]></title>
    <link href="http://yanping.me/cn/blog/2013/06/30/xccds-r-training/"/>
    <updated>2013-06-30T19:30:00+08:00</updated>
    <id>http://yanping.me/cn/blog/2013/06/30/xccds-r-training</id>
    <content type="html"><![CDATA[<p>最近北京和上海有两个R语言培训。</p>

<p>我的朋友<a href="http://www.weibo.com/u/1400524015">肖凯老师</a>最近要在上海开R语言的培训班。他是资深R语言用户，“<a href="http://xccds.github.io">数据科学与R语言</a>”博客博主，第五届R语言大会演讲嘉宾，上市公司（万达信息股份有限公司）数据分析部数据分析师。R语言领域的实战专家。</p>

<p>想要了解详情的请看<a href="http://ww3.sinaimg.cn/large/644c05aejw1e6iz4iuympj20c822qk13.jpg">这里</a>。</p>

<p>另一个培训是SupStat推出的RHadoop的培训，想要玩大数据的童鞋可以了解一下，请看<a href="http://bbs.it-home.org/forum.php?mod=viewthread&amp;tid=1876&amp;page=1&amp;extra=#pid5270">介绍</a>，SupStat的其他培训信息请看<a href="http://ypchen.inwake.com/files/upload/supstat-courses.pdf">这里</a>。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[【译文】软件工程师如何修炼数据科学]]></title>
    <link href="http://yanping.me/cn/blog/2013/05/25/software-engineers-guide-to-getting/"/>
    <updated>2013-05-25T19:30:00+08:00</updated>
    <id>http://yanping.me/cn/blog/2013/05/25/software-engineers-guide-to-getting</id>
    <content type="html"><![CDATA[<p class="info">写这篇文章的是位软件工程师，本文是他的数据科学修炼历程，原文在<a href="http://www.rcasts.com/2012/12/software-engineers-guide-to-getting.html">这里</a></p>

<p>很多软件攻城狮朋友问我如何学习数据科学。其实已经有不少有名的数据科学家写过这方面的文章，比如<a href="http://www.dataspora.com/2009/05/sexy-data-geeks/" target="_blank">Dataspora</a>, <a href="http://gigaom.com/data/why-becoming-a-data-scientist-might-be-easier-than-you-think" target="_blank">Gigaom</a>， <a href="http://www.quora.com/Career-Advice/How-do-I-become-a-data-scientist" target="_blank">Quora</a>和<a href="http://www.hilarymason.com/blog/getting-started-with-data-science/" target="_blank">Hilary Mason</a>。 本文讲述的是我作为一名软件工程师学习统计和数据可视化的历程。</p>

<p>我是半路出家的，花了5年时间成为数据科学领域的<a href="http://en.wikipedia.org/wiki/Dreyfus_model_of_skill_acquisition" target="_blank">熟练工（proficient）</a>，在我的学习过程中包括自学 （书籍, 博客, 简单实例）、工作中做项目、课堂培训(Stanford)、教学/演讲、会议（UseR, Strata）。 下面来讲讲到目前为止我做了哪些准备，其中哪些有用，哪些没用。</p>

<h2>1. 入门</h2>

<h3>a) 自学(2 - 4 个月)</h3>

<p><em>考察一下数据科学是否适合自己</em></p>

<p>入门很关键。两年前，我和几个同事组成了学习小组，一起学习<a href="http://stats202.com/" target="_blank">Stats 202</a>的课件。 这让我很兴趣，并且从那开始接触数据分析。 学习小组的5名成员中只有2名选择在这一领域研究的更深入（<a href="http://analytical-solution.com/2012/11/05/data-science-is-not-for-everyone/" target="_blank">数据科学并不适合所有人</a>）。<br /></p>
<ul>
<li><b>学习基础的统计学：</b><a href="http://stats202.com/" target="_blank">Stats 202</a>的课件非常适合入门</li>
<li><b>学习统计工具：</b> 作为一只菜鸟，我花了3个月的时间潜心学习。请看<a href="http://cran.r-project.org/" target="_blank">R</a> ，并获得了不少乐趣 <a href="http://www.rcasts.com/2011/03/why-learn-r.html" target="_blank">为什么学R</a>？</li>
<li><b>解决问题：</b>好奇心是数据科学的关键。如果你对国家经济、犯罪率统计以及体育比赛结果有疑问，那就找找数据自己解答你的疑问吧。</li>
<li><b>学习Unix工具：</b>我选择阅读 <a href="http://shop.oreilly.com/product/9780596802363.do" target="_blank">O'Reilly's Data Analysis with Open Source Tools (A hands-on guide for programmers and data scientists)</a></li>
<li><b>学习SQL和脚本语言：</b> 我会Java, Ruby和SQL。Python也在我的清单上。</li>
</ul>

<p>网上有很多学习资料</p>

<ul>
<li><a href="http://www.stanford.edu/class/stats202/" target="_blank">Stats 202</a></li>
<li><a href="http://work.caltech.edu/telecourse.html" target="_blank">Caltech Data Science course</a></li>
<li><a href="https://www.coursera.org/category/stats" target="_blank">Coursera</a>:&nbsp;<a href="https://www.coursera.org/course/datasci" target="_blank">Introduction to Data Science</a>,&nbsp;<a href="https://www.coursera.org/course/ml" target="_blank">Machine learning</a>,&nbsp;<a href="https://www.coursera.org/course/dataanalysis" target="_blank">Data Analysis</a>,&nbsp;<a href="https://www.coursera.org/course/compdata" target="_blank">Computing for Data Analysis</a></li>
<li><a href="http://datascienc.es/" target="_blank">University of California Berkeley - Introduction to Data Science</a></li>
<li><a href="http://open.journalismcourses.org/" target="_blank">Knight Center for Journalism's course on Introduction to Infographics and Data Visualization</a></li>
<li>Stats 101:&nbsp;<a href="http://www.udacity.com/overview/Course/st101/CourseRev/1" target="_blank">Udacity (Intro to Stats)</a>,&nbsp;<a href="https://www.khanacademy.org/math/probability/statistics" target="_blank">Khan academy</a>,&nbsp;<a href="http://oli.cmu.edu/courses/free-open/statistics-course-details/" target="_blank">Carnegie Mellon's stats course</a></li>
<li><a href="http://tryr.codeschool.com/" target="_blank">Learn R</a></li>
</ul>

<h3>b) 课堂培训 (9 - 12个月)</h3>

<p><em>如果你真的想学好，就参加一门正式的课程</em></p>

<p>如果你很认真地想学这门技术，那么最好参加课程学习。课程的艰难程度要保证我不会松懈。斯坦福提供了很棒的入门课程，比我参加的其他为期一周的培训课程要好很多。</p>

<ul>
<li><a href="http://www.stanford.edu/class/stats202/" target="_blank">Data Mining and Analysis STATS202</a></li>
<li><a href="http://www.stanford.edu/class/msande211/" target="_blank">Linear and Nonlinear Optimization MS&amp;E211</a></li>
<li><a href="http://www.stanford.edu/class/cs246/" target="_blank">Mining Massive Data Sets CS246</a></li>
<li><a href="http://www-stat.stanford.edu/~tibs/stat315a/" target="_blank">Modern Applied Statistics: Learning STATS315A</a></li>
<li>Statistical Methods in Finance STATS240P</li>
<li><a href="http://www.stanford.edu/class/stats315b/" target="_blank">Modern Applied Statistics: Data Mining&nbsp;STATS315B</a></li>
</ul>

<!--more-->

<h2>2. 专注</h2>

<h3>a) 在数据科学方面花100%的时间</h3>

<ul>
<li>当我沉迷于数据科学时，我发现想用20%的时间来构建专业知识是很困难的。 必须花100%的时间在上面， 所以我寻找跟数据科学有关的问题 （大数据分析、医疗、市场营销以及零售分析、 最优化等问题）来解决</li>
</ul>

<h3>b) 研究有趣的问题</h3>
<ul>
<li>我的学习目标总是跟我感兴趣的事物联系起来。当我学习新的技术时，我发现用所学的知识解决有趣的问题是很另人兴趣和着迷的事。我对零售、医疗和体育 （<a href="http://www.rcasts.com/search/label/cricket" target="_blank">板球</a>）方面的数据分析很感兴趣</li>
</ul>

<h3>c) 加速学习</h3>

<ul>
<li><b>教学：</b>我给同事和朋友<a href="http://www.rcasts.com/2010/11/learning-r.html" target="_blank">培训R</a>和<a href="http://www.rcasts.com/2012/03/data-analysis-training.html" target="_blank">数据挖掘的入门课程</a>。这使我所学的知识得到巩固，而且让其他人对这一领域感兴趣。 这是我回馈开源社区的最好方式，写博客也是将我所学知识贡献出来的好办法。</li>
<li><b>关注数据科学领域的领导者：</b><a href="http://www.linkedin.com/in/dpatil" target="_blank">DJ Patil</a>，<a href="http://www.hilarymason.com/" target="_blank">Hillary Mason</a>，<a href="http://jeffhammerbacher.com/" target="_blank">Jeff Hammerbacher</a>，<a href="http://analytical-solution.com/" target="_blank">Carla Gentry</a>，<a href="http://blog.linkedin.com/author/mrogati/" target="_blank">Monica Rogati</a>，<a href="http://mathbabe.org/" target="_blank">Cathy O'Neil</a>。还有其他这方面的领导者。</li>
<li><b>关注有趣的博客：</b><a href="http://datascience101.wordpress.com/">http://datascience101.wordpress.com</a>，<a href="http://columbiadatascience.com/blog">http://columbiadatascience.com/blog</a>，<a href="http://www.r-bloggers.com/">http://www.r-bloggers.com</a>，<a href="http://www.datawrangling.com/">http://www.datawrangling.com</a>，<a href="http://flowingdata.com/">http://flowingdata.com</a>（<a href="http://www.quora.com/What-are-the-best-blogs-about-data-Why" target="_blank">Quora的最佳博客列表</a>）</li>
<li><b>定期参加会议和聚会：</b>本地的数据科学/R语言方面的聚会，<a href="http://strata.oreilly.com/" target="_blank">O'Reilly Strata</a>非常棒！ 由于这个领域更新很快，所以我至少每隔一年去一次这个会议。<a href="http://www.r-project.org/conferences.html" target="_blank">UseR</a>会议 也很精彩，可以看看R语言世界发生了什么有趣的事。</li>
<li><b>学习大数据技术：</b>MapReduce/Hadoop，Cloud computing. 我避免选择商业软件 。现在看来，这是正确的决定。</li>
</ul>

<h3>d) 学习行业知识</h3>

<p>我很幸运，能够接触到数据科学内外的专家， 他们帮我理解他们处理数据科学问题的方法 （他们如何思考、 假设以及 test/access/reject解决方案)。我从他那里学到， “Hypothesis-driven data analysis”比”blind/brute-force data analysis”更加重要。这强调的重点是，对业务的理解要先于试图从数据中获取有意义的结论。 这引导我了解运筹、营销、零售、 旅行和物流（利润管理）以及医疗行业。 <a href="http://www.nytimes.com/2012/12/30/technology/big-data-is-great-but-dont-forget-intuition.html" target="_blank">纽约时报最近发表了一篇文章强调直觉的必要性</a>。</p>

<h2>
3. 数据科学方面有用的图书</h2>
<ul>
<li><a href="http://www.amazon.com/Introduction-Data-Mining-Pang-Ning-Tan/dp/0321321367" target="_blank">Introduction to Data Mining by Tan, Steinback and Kumar</a>&nbsp;这本教材被很多入门级数据科学课程采用，比如Stanford的Stats 202</li>
<li><a href="http://www.amazon.com/Nutshell-Desktop-Quick-Reference-OReilly/dp/059680170X" target="_blank">R in a nutshell</a></li>
<li><a href="http://www.amazon.com/Data-Analysis-Open-Source-Tools/dp/0596802358" target="_blank">Data Analysis by using Open Source tools</a></li>
<li><a href="http://www.amazon.com/Beautiful-Visualization-Looking-through-Practice/dp/1449379869" target="_blank">Beautiful visualization</a></li>
<li>其他数据科学领域的图书：<a href="http://shop.oreilly.com/category/get/data-science-kit.do" target="_blank">O'Reilly</a>,&nbsp;<a href="http://myemail.constantcontact.com/Data-Science-books-at-Manning.html?soid=1101335703814&amp;aid=F6MCzlEavBM" target="_blank">Manning</a></li>
</ul>

<h2>4. 对我没什么用的东西</h2>

<ul>
<li><b>学习多种统计工具：</b>一年以前，我接手的工作需要用到SAS编程，所以我想学SAS。我尝试了一个月，不过最终还是放弃了。主要原因是学习的惰性，以及我对另一种统计工具R的热爱。我实在不需要其他统计软件。我可以用R和其他我了解的软件<a href="http://cran.r-project.org/web/views/" target="_blank">解决数据科学里几乎所有的问题</a> 。所以我的建议是如果你已经对SAS，Stata，Matlab，SPSS，Statistica很熟悉，那就继续使用。如果你要学习新的统计工具，那就选R。 R 是开源软件，而其他软件是商业软件（昂贵且复杂）</li>
</ul>
<ul>
<li><b>在线公开课：</b>我曾经尝试在Coursera或其他 <a href="http://en.wikipedia.org/wiki/Massive_open_online_course" target="_blank">MOOC（在线公开课）</a>平台上自学，但是对于来说这样做效果并不理想。 我需要常规的、有压力的正式课程，经过艰苦的学习后能拿到学分</li>
</ul>
<ul>
<li><b>增加学术方面的工作量：</b>需要注意工作与生活的平衡。 今年早些时候，我尝试同时学习好几门很难的课程，后来很快意识到，我并不享受学习的过程。</li>
<li><b>只阅读课程教材：</b>很多课程的教材对我这样的软件工程师来说过于艰深了。所以我用其他资料来理解概念。比如，用<a href="http://www.stat.cmu.edu/~roeder/stat707/lectures.pdf" target="_blank">卡内基梅隆大学的笔记</a>学习回归</li>
</ul>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[《R语言编程艺术》即将上市]]></title>
    <link href="http://yanping.me/cn/blog/2013/05/15/the-art-of-r-programming-published/"/>
    <updated>2013-05-15T19:30:00+08:00</updated>
    <id>http://yanping.me/cn/blog/2013/05/15/the-art-of-r-programming-published</id>
    <content type="html"><![CDATA[<p style="height:0">
<a class="fancybox" style="text-decoration: none;" rel="gallery1" href="http://cos.name/wp-content/uploads/2013/05/art-of-r-big.jpg" title="The Art of R Programming">
    <img src="http://cos.name/wp-content/uploads/2013/05/art-of-r-235x300.jpg" title="Hosted by imgur.com" style="float:right;margin:0 0 10px 20px" />
</a>
</p>

<p>经历千辛万苦之后，<em>The Art of R Programming</em>这本书终于被我们翻译成了《R语言编程艺术》。去年五月份机械工业出版社的<a href="http://weibo.com/maywuyi">吴怡</a>编辑与统计之都洽谈翻译本书，到现在已经整整一年了。这本书与其他R语言图书有很大的不同，它是由著名计算机科学家兼统计学家Norman Matloff撰写，从编程的角度来讲解R语言，并且深入浅出，非常适合入门，也可作为有R语言使用经验的人进阶。也正由于这本书的特别之处，使得翻译过程异常艰难，好在我们还有统计之都各位大佬的支持，很多把握不准的术语都是求助于他们，在此表示感谢。我在译者序中对本书做了详细介绍。</p>

<h2 id="section">译者序</h2>

<p>R是一种用于统计计算和统计作图的开源软件，同时也是种编程语言，它广泛应用于企业和学术界的数据分析领域，正在成为最通用语言之一。由于近几年数据挖掘、大数据等概念的走红，R也越来越多地被人关注。截止到本文完成之日，CRAN（<a href="http://cran.r-project.org/">http://cran.r-project.org/</a>）上共有4383个包，涉及统计、化学、经济、生物、医学、心理、社会学等各个学科。不同类型的公司，比如Google、辉瑞、默克、美国银行、洲际酒店集团和壳牌公司都在使用它，同时以S语言环境为基础的R语言由于其鲜明的特色，一出现就受到了统计专业人士的青睐，成为国外大学里相当标准的统计软件。</p>

<p>一直以来，国内外关于R语言的著作都是以统计学专业的视角来介绍R语言的，对R语言本身的特性讲解得并不详尽，而软件自带的官方文档又显得过于技术，不那么亲民。另一方面，很多接触R的朋友都来自非计算机专业，没有接受过编程训练，他们使用R的时候，写出来的代码通常只能算是一条条命令的集合，面对更复杂的问题，常常束手无策。记得在某届R语言大会上，有位SAS阵营的朋友说，他看到演讲者所展示的代码里只有函数调用，没有编程的东西，所以他觉得R不能算一种编程语言。其实，他错了，此时你手里这本《R语言编程艺术》，覆盖了其他大部分R语言图书没有涉及到的编程主题。这本书就如同R语言的九阳神功秘籍，当神功练成，任督二脉一旦打通，再学习针对某一领域应用的函数或包就如庖丁解牛一般。顺便提一下，据微博上的小道消息，前面提到的那位朋友最近也开始学R了。</p>

<p><strong>本书的特点表现在以下几个方面：</strong></p>

<ul>
  <li>第一，对读者的统计学知识和编程水平要求并不高。与很多R语言书籍不同，这本书并不需要很深的统计学功底，它从纯语言的角度入手来讲解R。对于有一定编程经验却没什么统计学背景的人来说，读这本书会比较顺畅，读者就可以重点专注R语言的特性在数据分析方面的应用。在有的地方，作者也会提醒那些有其他语言编程经验的人应该注意R语言有什么不同之处。而对于没有编程经验又想使用R做数据分析的人来说，这本书也是学习编程的绝佳教材。</li>
  <li>第二，专注于R语言编程。作者没有把这本书定位为菜谱式的手册，也不像有些R语言图书那样介绍完统计学某方面应用之后简单地把R语言代码摆出来。翻开这本书的目录，你几乎看不到统计学的术语。本书系统介绍了R语言的各种数据结构和编程结构、面向对象编程方法、socket网络编程、并行计算、代码调试、程序性能提升以及R语言与其他语言的接口等主题。书中也提到了不少编程的小技巧，这都是作者多年编程经验的总结。</li>
  <li>第三，丰富的案例分析。作者Matloff教授是位计算机科学家，同时他也是位统计学家，有多年的教学经验，也做过统计学方法论的顾问。除了正文中的例子之外，本书还有44个扩展案例，很多案例源自作者亲身参与过的咨询项目。虽然本书没有讲解任何统计模型，但是扩展案例都是和数据分析相关的，比如鲍鱼数据的重编码（第二章）、寻找离群值（第三章）、文本词汇索引表（第四章）、汉语方言学习助手（第五章）等等。通过学习这些案例，读者不仅能学到R语言的每种概念如何运作，也会学到如何把这些概念组合到一起成为有用的程序。比如第十章介绍了socket网络编程之后，就用一个扩展案例讲解如何用socket实现并行计算，这为第十六章详细讲解并行计算做好了铺垫。在很多案例里，作者讨论了好几种设计方案，并比较了这几种方案的不同之处，以回答“为什么这样做？”，这对于缺少编程经验的人来说，是非常好的安排。</li>
</ul>

<!--more-->

<p>本书第一章简要介绍了R语言的几种数据结构和编程基础，其余章节可分为三大部分。</p>

<ul>
  <li>第一部分 （第二至六章）详细介绍R的几种主要的数据结构：向量、矩阵、列表、数据框和因子。对很多人来说，R复杂多变的数据结构真的是一只拦路虎。而本书从最简单的向量开始，一步一步引导读者认识并掌握各种数据结构。</li>
  <li>第二部分（第七至十三章）涉及编程方面： 编程结构和面向对象特性、输入/输出、 字符串处理以及绘图。值得一提的是第十三章，这章主要讲解的是R语言的调试。很多朋友在实际工作中有这样的经历，你可能用了一个小时就写好代码，却用了一天的时间来调试。可是到目前为止还没有在其他图书上看到与R语言调试相关的内容，甚至也很少见到关于其他编程语言调试的图书。本书刚好填补了这方面的空白。如果读者仔细读完第十三章，并实践其中的调试技巧，一定能事半功倍，也就能少熬点儿夜，有延长寿命的功效。本书的作者同时也著有《调式的艺术》（The Art of Debugging），相信他在R语言调试方面的功力也是相当深厚的。</li>
  <li>第三部分介绍的是更高级的内容，比如执行速度和性能的提升（第十四章）、R语言与C/C++或python混合编程（第十五章）以及R语言并行计算（第十六章） ，虽然最后一部分属于编程的高级内容，但如果读者从前往后一直学下来，随着能力的提高，也是可以读懂的。</li>
</ul>

<p>本人从2007年开始接触R语言，那时候市面上几乎没有R语言方面的书籍。当时我关于R语言的所有信息几乎都是来自统计之都（<a href="http://cos.name">http://cos.name</a>）和谢益辉的博客（<a href="http://yihui.name">http://yihui.name</a>）。2008年冬天，统计之都成功举办了“第一届中国R语言会议”，来自各地的R语言用户们齐聚一堂，交流心得。从那以后，每年的R语言会议都会在北京和上海举办。这几年来统计之都的队伍也逐渐壮大，比如本书的其他三位主要译者：邱怡轩、潘岚锋和熊熹，当年他们参加R语言会议的时候还是人大统计学院大一大二的学生，后来也成为R语言社区的领军人物。去年我们接到本书的翻译任务时，他们三人分别收到了普度大学、爱荷华州立大学以及明尼苏达大学的录取通知，现在已经在美国留学深造。希望有越来越多的人加入统计之都的大家庭，和大家一起成长，为中国统计事业的发展尽自己的一份力。</p>

<p>在翻译过程中，几位译者力求忠实于原文，同时也兼顾中文表达的流畅，不过译文中仍可能有不当之处，欢迎读者予以指正。</p>

<p>除了本人以及前面提到的三位译者之外，统计之都的三位老朋友林宇、严紫丹和程豪也参与了本书部分章节的校审和初稿翻译，在此表示感谢。全书译文最后由本人统稿，如有错误之处，均由本人承担。</p>

<p>也感谢机械工业出版社的吴怡女士，她给予了我们细心帮助。</p>

<p>读者可以在统计之都的图书出版栏目（网址是<a href="http://cos.name/books/">http://cos.name/books/</a>）查看本书的页面，您可以在这里下载本书的数据和代码，也可以留言提问。</p>

<div style="width:300px;text-align:right;float:right">
陈堰平<br />
2013年3月于新华通讯社第三工作区
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[用js在jekyll博客中实现标签云和标签页]]></title>
    <link href="http://yanping.me/cn/blog/2013/02/13/generate-tags-with-js-in-jekyll-blog/"/>
    <updated>2013-02-13T15:30:00+08:00</updated>
    <id>http://yanping.me/cn/blog/2013/02/13/generate-tags-with-js-in-jekyll-blog</id>
    <content type="html"><![CDATA[<p class="info">本文主要讨论在jekyll博客中借助javascript和json，实现标签云和标签页。标签云可以用jquery.tagcloud.js插件实现，标签页则使用jQuery读取json数据文件，用地址传递参数给js函数，使用的是异步加载技术，请看<a href="http://art.yanping.me/tags/">演示页面</a>。</p>

<h2 id="section">标签云</h2>

<p>先做点准备工作，加载jquery。因为我的博客里还加载了其他的js库，在另外一个js库中也定义了$符号的话，那么我们在使用$符号时就发生了冲突。所以在加载jquery时还要解决$命名冲突。请看<a href="http://www.cnblogs.com/RascallySnake/archive/2010/05/07/1729417.html">这篇文章</a>，我用的办法是定义jQuery的别名：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span /></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="html"><span class="line"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;/js/jquery-1.7.1.min.js&quot;</span> <span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">charset=</span><span class="s">&quot;utf-8&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class="line"><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
</span><span class="line">  <span class="kd">var</span> <span class="nx">jq</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">noConflict</span><span class="p">();</span>
</span><span class="line"><span class="nt">&lt;/script&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>下面是标签云的代码：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span /></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
</pre></td><td class="code"><pre><code class="html"><span class="line"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;/js/jquery.tagcloud.js&quot;</span> <span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">charset=</span><span class="s">&quot;utf-8&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class="line"><span class="nt">&lt;script </span><span class="na">language=</span><span class="s">&quot;javascript&quot;</span><span class="nt">&gt;</span>
</span><span class="line">  <span class="nx">jq</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">tagcloud</span><span class="p">.</span><span class="nx">defaults</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="line">    <span class="nx">size</span><span class="o">:</span> <span class="p">{</span>
</span><span class="line">      <span class="nx">start</span><span class="o">:</span> <span class="mi">12</span><span class="p">,</span>
</span><span class="line">      <span class="nx">end</span><span class="o">:</span> <span class="mi">22</span><span class="p">,</span>
</span><span class="line">      <span class="nx">unit</span><span class="o">:</span> <span class="s1">&#39;px&#39;</span>
</span><span class="line">    <span class="p">},</span>
</span><span class="line">    <span class="nx">color</span><span class="o">:</span> <span class="p">{</span>
</span><span class="line">      <span class="nx">start</span><span class="o">:</span> <span class="s1">&#39;#7CCD7C&#39;</span><span class="p">,</span>
</span><span class="line">      <span class="nx">end</span><span class="o">:</span> <span class="s1">&#39;#CD0000&#39;</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">  <span class="p">};</span>
</span><span class="line">
</span><span class="line">  <span class="nx">jq</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class="line">    <span class="nx">jq</span><span class="p">(</span><span class="s1">&#39;#tag_cloud a&#39;</span><span class="p">).</span><span class="nx">tagcloud</span><span class="p">();</span>
</span><span class="line">  <span class="p">});</span>
</span><span class="line"><span class="nt">&lt;/script&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="section-1">标签页</h2>

<p>最初，我是在谢益辉的博客里看到的<a href="http://yihui.name/cn/tags/">用js实现标签云</a>。可以看到，这个标签页上，在标签云之后跟着各个标签的文章列表，如果我只想看到某个标签的文章列表，要怎么做呢？</p>

<p>前面我写了篇文章<a href="http://yanping.me/cn/blog/2012/10/10/asynchronous-loading-post-list-with-jekyll-and-jQuery/">《用jekyll和jQuery实现异步加载文章列表》</a>，使用jQuery异步加载文章列表。同样的，我们也可以编写个函数加载某个标签的所有文章的列表。</p>

<!--more-->

<p>首先，生成文章列表数据的json模板是：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span /></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
</pre></td><td class="code"><pre><code class="html"><span class="line">---
</span><span class="line">layout: nil
</span><span class="line">---
</span><span class="line">
</span><span class="line">[
</span><span class="line">{% for post in site.posts %}
</span><span class="line">  {&quot;title&quot;:&quot;{{post.title}}&quot;,
</span><span class="line">  &quot;url&quot;:&quot;{{site.url}}{{post.url}}&quot;,
</span><span class="line">  &quot;date&quot;:&quot;{{ post.date | date:&#39;%Y-%m-%d&#39; }}&quot;,
</span><span class="line">  &quot;tags&quot;:[{% for tag in post.tags %}&quot;{{tag}}&quot;{% if forloop.last == false %} ,{% endif %}{% endfor %}]}
</span><span class="line">  {% if forloop.last == false %},{% endif %}{% endfor %}
</span><span class="line">]
</span><span class="line">
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>用jekyll处理之后得到的json文件在<a href="http://art.yanping.me/post.json">这里</a>。</p>

<p>定义javascript函数showTag()，异步加载某一个标签的文章列表</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span /></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
</pre></td><td class="code"><pre><code class="html"><span class="line"><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
</span><span class="line">  <span class="kd">function</span> <span class="nx">showTag</span><span class="p">(</span><span class="nx">tagStr</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="nx">jq</span><span class="p">.</span><span class="nx">getJSON</span><span class="p">(</span><span class="s2">&quot;../post.json&quot;</span><span class="p">,</span>
</span><span class="line">    <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">      <span class="nx">jq</span><span class="p">(</span><span class="s1">&#39;#show-tag&#39;</span><span class="p">).</span><span class="nx">empty</span><span class="p">(</span><span class="nx">content</span><span class="p">);</span>
</span><span class="line">      <span class="kd">var</span> <span class="nx">content</span> <span class="o">=</span> <span class="s2">&quot;&lt;h2&gt;分类：&quot;</span> <span class="o">+</span> <span class="nx">tagStr</span> <span class="o">+</span> <span class="s2">&quot;&lt;/h2&gt;&lt;ul class=\&quot;posts\&quot;&gt;&quot;</span><span class="p">;</span>
</span><span class="line">      <span class="kd">var</span> <span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class="line">      <span class="nx">jq</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span>
</span><span class="line">      <span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">        <span class="nx">jq</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">tags</span><span class="p">,</span>
</span><span class="line">        <span class="kd">function</span><span class="p">(</span><span class="nx">j</span><span class="p">,</span> <span class="nx">tag</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">          <span class="k">if</span> <span class="p">(</span><span class="nx">tag</span> <span class="o">==</span> <span class="nx">tagStr</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">            <span class="nx">content</span> <span class="o">+=</span> <span class="s2">&quot;&lt;li class=\&quot;listing-item\&quot;&gt;&lt;time datetime=\&quot;&quot;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">date</span> <span class="o">+</span> <span class="s2">&quot;\&quot;&gt;&quot;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">date</span> <span class="o">+</span> <span class="s2">&quot;&lt;/time&gt;&lt;a href=\&quot;&quot;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">url</span> <span class="o">+</span> <span class="s2">&quot;\&quot;&gt;&quot;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">title</span> <span class="o">+</span> <span class="s2">&quot;&lt;/a&gt;&lt;/li&gt;&quot;</span><span class="p">;</span>
</span><span class="line">            <span class="nx">count</span><span class="o">++</span><span class="p">;</span>
</span><span class="line">          <span class="p">}</span>
</span><span class="line">
</span><span class="line">        <span class="p">});</span>
</span><span class="line">      <span class="p">});</span>
</span><span class="line">      <span class="k">if</span> <span class="p">(</span><span class="nx">count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">        <span class="nx">content</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/ul&gt;&quot;</span><span class="p">;</span>
</span><span class="line">        <span class="nx">postNumStr</span> <span class="o">=</span> <span class="s2">&quot;&lt;span&gt;（&quot;</span> <span class="o">+</span> <span class="nx">count</span> <span class="o">+</span> <span class="s2">&quot;篇文章）&lt;/span&gt;&quot;</span><span class="p">;</span>
</span><span class="line">        <span class="nx">jq</span><span class="p">(</span><span class="s1">&#39;#show-tag&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">content</span><span class="p">);</span>
</span><span class="line">        <span class="nx">jq</span><span class="p">(</span><span class="s1">&#39;#show-tag&gt;h2&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">postNumStr</span><span class="p">);</span>
</span><span class="line">      <span class="p">}</span>
</span><span class="line">    <span class="p">});</span>
</span><span class="line">  <span class="p">}</span>
</span><span class="line"><span class="nt">&lt;/script&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>而标签页的核心代码为</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span /></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
</pre></td><td class="code"><pre><code class="html"><span class="line"><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;tag_cloud&quot;</span><span class="nt">&gt;</span>
</span><span class="line">  {% for tag in site.tags %}
</span><span class="line">  <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;javascript:;&quot;</span> <span class="na">onclick=</span><span class="s">&quot;showTag(&#39;{{ tag[0] }}&#39;)&quot;</span> <span class="na">title=</span><span class="s">&quot;{{ tag[0] }}&quot;</span> <span class="na">rel=</span><span class="s">&quot;{{ tag[1].size }}&quot;</span><span class="nt">&gt;</span>
</span><span class="line">    {{ tag[0] }}
</span><span class="line">  <span class="nt">&lt;/a&gt;</span>
</span><span class="line">  {% endfor %}
</span><span class="line">  <span class="nt">&lt;/div&gt;</span>
</span><span class="line">
</span><span class="line"><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;show-tag&quot;</span><span class="nt">&gt;</span>
</span><span class="line">  <span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">&quot;text-align:center&quot;</span><span class="nt">&gt;</span>
</span><span class="line">    <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">&quot;/images/loading.gif&quot;</span><span class="nt">/&gt;</span><span class="ni">&amp;nbsp;&amp;nbsp;</span>loading...
</span><span class="line">  <span class="nt">&lt;/div&gt;</span>
</span><span class="line"><span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>戳<a href="https://raw.github.com/yanping/art/gh-pages/tags/index.html">这里</a>查看完整代码。</p>

<p>下面这段代码用url地址来传递参数</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span /></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
</pre></td><td class="code"><pre><code class="html"><span class="line"><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
</span><span class="line">  <span class="kd">var</span> <span class="nx">href</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="p">;</span>
</span><span class="line">  <span class="kd">var</span> <span class="nx">pos</span> <span class="o">=</span> <span class="nx">href</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;?tag=&#39;</span><span class="p">);</span>
</span><span class="line">  <span class="kd">var</span> <span class="nx">paraStr</span> <span class="o">=</span> <span class="nx">href</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">pos</span> <span class="o">+</span> <span class="mi">5</span><span class="p">);</span>
</span><span class="line">  <span class="k">if</span> <span class="p">(</span><span class="nx">pos</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="nx">showTag</span><span class="p">(</span><span class="nb">decodeURI</span><span class="p">(</span><span class="nx">paraStr</span><span class="p">));</span>
</span><span class="line">  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class="line">    <span class="nx">showTag</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">);</span>
</span><span class="line">  <span class="p">}</span>
</span><span class="line"><span class="nt">&lt;/script&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>post模板里的标签列表部分代码：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span /></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
</pre></td><td class="code"><pre><code class="html"><span class="line">{% if page.tags != empty %}
</span><span class="line"><span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">&quot;tags emphnext&quot;</span><span class="nt">&gt;</span>
</span><span class="line">  <span class="nt">&lt;li&gt;</span>标签：<span class="nt">&lt;/li&gt;</span>
</span><span class="line">  {% for tag in page.tags %}
</span><span class="line">  <span class="nt">&lt;li&gt;</span>
</span><span class="line">    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;{{ site.baseurl }}/tags/?tag={{tag | cgi}}&quot;</span><span class="nt">&gt;</span>
</span><span class="line">      {{ tag }}
</span><span class="line">    <span class="nt">&lt;/a&gt;</span>
</span><span class="line">    {% if forloop.last == false %}, {%endif %}
</span><span class="line">  <span class="nt">&lt;/li&gt;</span>
</span><span class="line">  {% endfor %}
</span><span class="line"><span class="nt">&lt;/ul&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>侧面栏上标签列表的代码：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span /></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
</pre></td><td class="code"><pre><code class="html"><span class="line"><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;tag_sidebar&quot;</span><span class="nt">&gt;</span>
</span><span class="line">  {% for tag in site.tags %}
</span><span class="line">  <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;{{site.baseurl}}/tags/?tag={{tag[0] | cgi}}&quot;</span> <span class="na">title=</span><span class="s">&quot;{{ tag[0] }}&quot;</span><span class="nt">&gt;</span>
</span><span class="line">    {{ tag[0] }}<span class="nt">&lt;sup&gt;</span>{{ tag[1].size }}<span class="nt">&lt;/sup&gt;</span><span class="ni">&amp;nbsp;</span>
</span><span class="line">  <span class="nt">&lt;/a&gt;</span>
</span><span class="line">  {% endfor %}
</span><span class="line"><span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[用R获取flash中的数据]]></title>
    <link href="http://yanping.me/cn/blog/2013/02/10/get-data-from-flash/"/>
    <updated>2013-02-10T02:00:00+08:00</updated>
    <id>http://yanping.me/cn/blog/2013/02/10/get-data-from-flash</id>
    <content type="html"><![CDATA[<p class="info">本文主要讨论如何用R语言从flash中获取数据</p>

<p>某天我需要获取<a href="http://ifsfd.fudan.edu.cn/fdurmb/indexchart1.jsp">复旦人民币汇率指数</a>的数据。此前我们介绍过从网页抓取数据的两种方法</p>

<ol>
  <li>用url给服务器提交参数获取数据文件，例如<a href="http://yanping.me/cn/blog/2012/12/09/get-dce-data/">用R获取大连商品交易所历史数据</a>这篇文章里提到的方法</li>
  <li>解析html代码以获取数据，例如<a href="http://yanping.me/cn/blog/2013/02/09/get-zce-data/">用R获取郑州商品交易所历史数据</a>这篇文章里提到的方法</li>
</ol>

<p>而复旦的这个网页，不提供数据文件的下载，从html中也不能解析出数据。实际上，该网页中的flash向服务器发送请求，服务器返回数据给flash并显示出图形和表格。</p>

<p>用<a href="http://cos.name/cn/topic/107729">http://cos.name/cn/topic/107729</a>中<a href="http://www.road2stat.com/">Xiao Nan版主</a>介绍的办法，我用chrome看了下页面</p>

<p><img src="http://i.imgur.com/OqZSfRa.png" alt="network -&gt; XHR" /></p>

<p>可以看到，上图中的表是从2012年12月12日到2013年2月10日的数据，对应的数据来自<a href="http://ifsfd.fudan.edu.cn/fdurmb/data?type=0%2C1%2C2&amp;df=2012%2F12%2F12&amp;dt=2013%2F02%2F10">http://ifsfd.fudan.edu.cn/fdurmb/data?type=0%2C1%2C2&amp;df=2012%2F12%2F12&amp;dt=2013%2F02%2F10</a>，打开这个链接，可以看出这是JSON格式，用R的rjson和RJSONIO包都可以解析JSON格式的数据。</p>

<p>我们来研究一下上面的这个链接，<code>df=2012%2F12%2F12&amp;dt=2013%2F02%2F10</code>规定了从开始到结束的日期，如果开始日期是YYYY年MM月DD日，结束日期是yyyy年mm月dd日，那么对应的字符串是<code>df=YYYY%2FMM%2FDD&amp;dt=yyyy%2Fmm%2Fdd</code></p>

<p>那么文本开头提出的问题，可用下面的代码解决</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span> (readFudan.r)</span> <a href="http://yanping.me/cn/downloads/code/readFudan.r">download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
</pre></td><td class="code"><pre><code class="r"><span class="line"><span class="c1"># 从复旦人民币汇率指数网站读取数据 http://ifsfd.fudan.edu.cn/fdurmb/indexchart1.jsp</span>
</span><span class="line"><span class="c1"># 更多细节请看 http://cos.name/cn/topic/109132</span>
</span><span class="line">
</span><span class="line">require<span class="p">(</span>RCurl<span class="p">)</span>
</span><span class="line">require<span class="p">(</span>rjson<span class="p">)</span>
</span><span class="line">
</span><span class="line">fdjson <span class="o">&lt;-</span> getURL<span class="p">(</span><span class="s">&quot;http://ifsfd.fudan.edu.cn/fdurmb/data?type=0%2C1%2C2&amp;df=2012%2F12%2F12&amp;dt=2013%2F02%2F10&quot;</span><span class="p">)</span>
</span><span class="line">fdlist <span class="o">&lt;-</span> fromJSON<span class="p">(</span>fdjson<span class="p">)</span>
</span><span class="line">fdm <span class="o">&lt;-</span> matrix<span class="p">(</span>unlist<span class="p">(</span>fdlist<span class="p">),</span>ncol<span class="o">=</span><span class="m">4</span><span class="p">,</span>byrow<span class="o">=</span><span class="k-Variable">T</span><span class="p">)</span>
</span><span class="line">fddf <span class="o">&lt;-</span> data.frame<span class="p">(</span>fdm<span class="p">,</span> stringsAsFactors <span class="o">=</span> <span class="k-Variable">F</span><span class="p">)</span>
</span><span class="line">fddf<span class="p">[,</span><span class="m">2</span>:<span class="m">4</span><span class="p">]</span> <span class="o">&lt;-</span> sapply<span class="p">(</span>fddf<span class="p">[,</span><span class="m">2</span>:<span class="m">4</span><span class="p">],</span>as.numeric<span class="p">)</span>
</span><span class="line">colnames<span class="p">(</span>fddf<span class="p">)</span> <span class="o">&lt;-</span> c<span class="p">(</span><span class="s">&quot;date&quot;</span><span class="p">,</span><span class="s">&quot;人民币名义有效汇率指数&quot;</span><span class="p">,</span><span class="s">&quot;人民币实际有效汇率指数&quot;</span><span class="p">,</span><span class="s">&quot;人民币盯住一篮子货币模拟汇率指数&quot;</span><span class="p">)</span>
</span><span class="line">write.csv<span class="p">(</span>fddf<span class="p">,</span><span class="s">&quot;fudan.csv&quot;</span><span class="p">,</span>row.names <span class="o">=</span> <span class="k-Variable">F</span> <span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[R语言版的cntrade程序]]></title>
    <link href="http://yanping.me/cn/blog/2013/02/10/cntrade-r-version/"/>
    <updated>2013-02-10T02:00:00+08:00</updated>
    <id>http://yanping.me/cn/blog/2013/02/10/cntrade-r-version</id>
    <content type="html"><![CDATA[<p class="info">本文展示的是R语言版的cntrade程序</p>

<p>李春涛和张璇两位老师写了个<a href="http://ideas.repec.org/c/boc/bocode/s457580.html">名叫cntrade的stata程序</a>，用来从网易财经网获取沪深两市股票日度行情数据。</p>

<p>我用R重写了这个程序，请看：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span> (cntrade.r)</span> <a href="http://yanping.me/cn/downloads/code/cntrade.r">download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
<span class="line-number">38</span>
<span class="line-number">39</span>
<span class="line-number">40</span>
<span class="line-number">41</span>
<span class="line-number">42</span>
<span class="line-number">43</span>
<span class="line-number">44</span>
<span class="line-number">45</span>
<span class="line-number">46</span>
<span class="line-number">47</span>
<span class="line-number">48</span>
<span class="line-number">49</span>
<span class="line-number">50</span>
<span class="line-number">51</span>
<span class="line-number">52</span>
<span class="line-number">53</span>
<span class="line-number">54</span>
<span class="line-number">55</span>
<span class="line-number">56</span>
<span class="line-number">57</span>
<span class="line-number">58</span>
<span class="line-number">59</span>
<span class="line-number">60</span>
<span class="line-number">61</span>
</pre></td><td class="code"><pre><code class="r"><span class="line"><span class="c1"># cntrade R语言版 </span>
</span><span class="line"><span class="c1"># 作者：陈堰平（统计之都，chen@yanping.me） </span>
</span><span class="line"><span class="c1"># 使用网易股票数据接口 原stata版的作者为：</span>
</span><span class="line"><span class="c1">#   李春涛（中南财经政法大学，chtl@znufe.edu.cn） </span>
</span><span class="line"><span class="c1">#   张璇（中南财经政法大学，zhangx@znufe.edu.cn） </span>
</span><span class="line"><span class="c1"># example: </span>
</span><span class="line"><span class="c1">#   cntrade(c(&#39;600000&#39;, &#39;000008&#39;), path =&#39;D:/stockprice&#39;, start = 20010104, end = 20120124)</span>
</span><span class="line">
</span><span class="line">cntrade <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>tickers<span class="p">,</span> path <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span> start <span class="o">=</span> <span class="m">19910101</span><span class="p">,</span> end <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">
</span><span class="line">  address <span class="o">&lt;-</span> <span class="s">&quot;http://quotes.money.163.com/service/chddata.html&quot;</span>
</span><span class="line">  field <span class="o">&lt;-</span> <span class="s">&quot;&amp;fields=TCLOSE;HIGH;LOW;TOPEN;LCLOSE;CHG;PCHG;TURNOVER;VOTURNOVER;VATURNOVER;TCAP;MCAP&quot;</span>
</span><span class="line">
</span><span class="line">  <span class="kr">if</span> <span class="p">(</span>path <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    path <span class="o">&lt;-</span> getwd<span class="p">()</span>
</span><span class="line">  <span class="p">}</span>
</span><span class="line">
</span><span class="line">  <span class="kr">if</span> <span class="p">(</span>!file.exists<span class="p">(</span>path<span class="p">))</span> <span class="p">{</span>
</span><span class="line">    dir.create<span class="p">(</span>path<span class="p">)</span>
</span><span class="line">  <span class="p">}</span>
</span><span class="line">
</span><span class="line">  <span class="kr">if</span> <span class="p">(</span>substr<span class="p">(</span>path<span class="p">,</span> nchar<span class="p">(</span>path<span class="p">),</span> nchar<span class="p">(</span>path<span class="p">))</span> <span class="o">!=</span> <span class="s">&quot;/&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    path <span class="o">&lt;-</span> paste<span class="p">(</span>path<span class="p">,</span> <span class="s">&quot;/&quot;</span><span class="p">,</span> sep <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
</span><span class="line">  <span class="p">}</span>
</span><span class="line">
</span><span class="line">  <span class="kr">if</span> <span class="p">(</span>end <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    year <span class="o">&lt;-</span> substr<span class="p">(</span>Sys.time<span class="p">(),</span> <span class="m">1</span><span class="p">,</span> <span class="m">4</span><span class="p">)</span>
</span><span class="line">    month <span class="o">&lt;-</span> substr<span class="p">(</span>Sys.time<span class="p">(),</span> <span class="m">6</span><span class="p">,</span> <span class="m">7</span><span class="p">)</span>
</span><span class="line">    day <span class="o">&lt;-</span> substr<span class="p">(</span>Sys.time<span class="p">(),</span> <span class="m">9</span><span class="p">,</span> <span class="m">10</span><span class="p">)</span>
</span><span class="line">    end <span class="o">&lt;-</span> paste<span class="p">(</span>year<span class="p">,</span> month<span class="p">,</span> day<span class="p">,</span> sep <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
</span><span class="line">  <span class="p">}</span>
</span><span class="line">
</span><span class="line">  count <span class="o">&lt;-</span> <span class="m">0</span>
</span><span class="line">  tickers <span class="o">&lt;-</span> as.character<span class="p">(</span>tickers<span class="p">)</span>
</span><span class="line">  <span class="kr">for</span> <span class="p">(</span>name in tickers<span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="kr">while</span> <span class="p">(</span>nchar<span class="p">(</span>name<span class="p">)</span> <span class="o">&lt;</span> <span class="m">6</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">      name <span class="o">&lt;-</span> paste<span class="p">(</span><span class="s">&quot;0&quot;</span><span class="p">,</span> name<span class="p">,</span> sep <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">
</span><span class="line">    <span class="kr">if</span> <span class="p">(</span>nchar<span class="p">(</span>name<span class="p">)</span> <span class="o">&gt;</span> <span class="m">6</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">      warning<span class="p">(</span>paste<span class="p">(</span><span class="s">&quot;invalid stock code: &quot;</span><span class="p">,</span> name<span class="p">,</span> sep <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">))</span>
</span><span class="line">      next
</span><span class="line">    <span class="p">}</span>
</span><span class="line">
</span><span class="line">    <span class="kr">if</span> <span class="p">(</span>as.numeric<span class="p">(</span>name<span class="p">)</span> <span class="o">&gt;</span> <span class="m">600000</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">      url <span class="o">&lt;-</span> paste<span class="p">(</span>address<span class="p">,</span> <span class="s">&quot;?code=0&quot;</span><span class="p">,</span> name<span class="p">,</span> <span class="s">&quot;&amp;start=&quot;</span><span class="p">,</span> start<span class="p">,</span> <span class="s">&quot;&amp;end=&quot;</span><span class="p">,</span> end<span class="p">,</span> field<span class="p">,</span> sep <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
</span><span class="line">    <span class="p">}</span> <span class="kr">else</span> <span class="p">{</span>
</span><span class="line">      url <span class="o">&lt;-</span> paste<span class="p">(</span>address<span class="p">,</span> <span class="s">&quot;?code=1&quot;</span><span class="p">,</span> name<span class="p">,</span> <span class="s">&quot;&amp;start=&quot;</span><span class="p">,</span> start<span class="p">,</span> <span class="s">&quot;&amp;end=&quot;</span><span class="p">,</span> end<span class="p">,</span> field<span class="p">,</span> sep <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">    destfile <span class="o">&lt;-</span> paste<span class="p">(</span>path<span class="p">,</span> name<span class="p">,</span> <span class="s">&quot;.csv&quot;</span><span class="p">,</span> sep <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
</span><span class="line">    download.file<span class="p">(</span>url<span class="p">,</span> destfile<span class="p">,</span> quiet <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span><span class="line">    count <span class="o">&lt;-</span> count <span class="o">+</span> <span class="m">1</span>
</span><span class="line">  <span class="p">}</span>
</span><span class="line">
</span><span class="line">  <span class="kr">if</span> <span class="p">(</span>count <span class="o">==</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    cat<span class="p">(</span><span class="s">&quot;一个数据文件都没下载下来！\n&quot;</span><span class="p">)</span>
</span><span class="line">  <span class="p">}</span> <span class="kr">else</span> <span class="p">{</span>
</span><span class="line">    cat<span class="p">(</span><span class="s">&quot;数据下载完成！\n&quot;</span><span class="p">)</span>
</span><span class="line">    cat<span class="p">(</span>paste<span class="p">(</span><span class="s">&quot;共下载&quot;</span><span class="p">,</span> count<span class="p">,</span> <span class="s">&quot;个文件\n&quot;</span><span class="p">,</span> sep <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">))</span>
</span><span class="line">  <span class="p">}</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>调用举例</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span /></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="r"><span class="line">cntrade<span class="p">(</span>c<span class="p">(</span><span class="s">&#39;600000&#39;</span><span class="p">,</span> <span class="s">&#39;000001&#39;</span><span class="p">,</span> <span class="s">&#39;600810&#39;</span><span class="p">),</span> path <span class="o">=</span> <span class="s">&quot;d:\temp&quot;</span><span class="p">,</span> start <span class="o">=</span> <span class="m">19990101</span><span class="p">,</span> end <span class="o">=</span> <span class="m">20121231</span><span class="p">)</span>
</span><span class="line">cntrade<span class="p">(</span>c<span class="p">(</span><span class="m">600000</span><span class="p">,</span> <span class="m">000001</span><span class="p">,</span> <span class="m">600810</span><span class="p">))</span>
</span><span class="line">cntrade<span class="p">(</span><span class="s">&#39;000002&#39;</span><span class="p">,</span> start <span class="o">=</span> <span class="m">19990101</span><span class="p">)</span>
</span><span class="line">cntrade<span class="p">(</span><span class="m">000002</span><span class="p">,</span> end <span class="o">=</span> <span class="m">19990101</span><span class="p">)</span>
</span><span class="line">cntrade<span class="p">(</span>c<span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">16</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>stata版的介绍请看<a href="http://blog.sina.com.cn/s/blog_6af14ae20101ggnz.html">http://blog.sina.com.cn/s/blog_6af14ae20101ggnz.html</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[用R获取郑州商品交易所历史数据]]></title>
    <link href="http://yanping.me/cn/blog/2013/02/09/get-zce-data/"/>
    <updated>2013-02-09T20:00:00+08:00</updated>
    <id>http://yanping.me/cn/blog/2013/02/09/get-zce-data</id>
    <content type="html"><![CDATA[<p class="info">本文主要讨论如何用R语言从郑州商品交易所网站上获取期货合约交易数据</p>

<p>郑商所网站提供了查询每日行情的<a href="http://www.czce.com.cn/portal/jysj/mrhq/A091101index_1.htm">页面</a>，它提供的数据比大商所的要复杂一些，2010年至2013年的网页格式一样，地址也是同样的形式，请看</p>

<ul>
  <li><a href="http://www.czce.com.cn/portal/exchange/2010/datadaily/20100105.htm">http://www.czce.com.cn/portal/exchange/2010/datadaily/20100105.htm</a></li>
  <li><a href="http://www.czce.com.cn/portal/exchange/2011/datadaily/20110105.htm">http://www.czce.com.cn/portal/exchange/2011/datadaily/20110105.htm</a></li>
  <li><a href="http://www.czce.com.cn/portal/exchange/2012/datadaily/20120104.htm">http://www.czce.com.cn/portal/exchange/2012/datadaily/20120104.htm</a></li>
  <li><a href="http://www.czce.com.cn/portal/exchange/2013/datadaily/20130104.htm">http://www.czce.com.cn/portal/exchange/2013/datadaily/20130104.htm</a></li>
</ul>

<p>打开网页可以看到，网页提供了“打印”，“Excel”和“txt”三个选项，只要把地址后面的<code>.html</code>改为<code>.txt</code>就可以得到文本格式的数据，那么就可以逐一下载数据文件，读入数据。</p>

<p>这四年的数据可以这样获取：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span /></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
</pre></td><td class="code"><pre><code class="r"><span class="line">getZceData <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>dates<span class="p">){</span>
</span><span class="line">  require<span class="p">(</span>RCurl<span class="p">)</span>
</span><span class="line">  zceDatabase <span class="o">&lt;-</span> data.frame<span class="p">()</span>
</span><span class="line">  <span class="kr">for</span> <span class="p">(</span>date in dates<span class="p">)</span> <span class="p">{</span>
</span><span class="line">    str1 <span class="o">&lt;-</span> <span class="s">&quot;http://www.czce.com.cn/portal/exchange/&quot;</span>
</span><span class="line">    str2 <span class="o">&lt;-</span> <span class="s">&quot;/datadaily/&quot;</span>
</span><span class="line">    date <span class="o">&lt;-</span> as.character<span class="p">(</span>date<span class="p">)</span>
</span><span class="line">    year <span class="o">&lt;-</span> substr<span class="p">(</span>date<span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">4</span><span class="p">)</span>
</span><span class="line">    url <span class="o">&lt;-</span> paste<span class="p">(</span>str1<span class="p">,</span> year<span class="p">,</span> str2<span class="p">,</span> date<span class="p">,</span> <span class="s">&quot;.txt&quot;</span><span class="p">,</span> sep <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
</span><span class="line">    <span class="kr">if</span> <span class="p">(</span>!url.exists<span class="p">(</span>url<span class="p">))</span> <span class="p">{</span>
</span><span class="line">      next
</span><span class="line">    <span class="p">}</span> <span class="kr">else</span> <span class="p">{</span>
</span><span class="line">      colnames <span class="o">&lt;-</span> c<span class="p">(</span><span class="s">&quot;品种月份&quot;</span><span class="p">,</span> <span class="s">&quot;昨结箿&quot;</span><span class="p">,</span> <span class="s">&quot;今开盘&quot;</span><span class="p">,</span> <span class="s">&quot;最高价&quot;</span><span class="p">,</span> <span class="s">&quot;最低价&quot;</span><span class="p">,</span>
</span><span class="line">        <span class="s">&quot;今收盘&quot;</span><span class="p">,</span> <span class="s">&quot;今结算&quot;</span><span class="p">,</span> <span class="s">&quot;涨跌1&quot;</span><span class="p">,</span> <span class="s">&quot;涨跌2&quot;</span><span class="p">,</span> <span class="s">&quot;成交量&quot;</span><span class="p">,</span> <span class="s">&quot;空盘量&quot;</span><span class="p">,</span>
</span><span class="line">        <span class="s">&quot;增减量&quot;</span><span class="p">,</span> <span class="s">&quot;成交额&quot;</span><span class="p">,</span> <span class="s">&quot;交割结算价&quot;</span><span class="p">)</span>
</span><span class="line">      fileName <span class="o">&lt;-</span> paste<span class="p">(</span><span class="s">&quot;zce&quot;</span><span class="p">,</span> date<span class="p">,</span> <span class="s">&quot;.txt&quot;</span><span class="p">,</span> sep <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
</span><span class="line">
</span><span class="line">      <span class="kr">if</span> <span class="p">(</span>!file.exists<span class="p">(</span>fileName<span class="p">))</span> <span class="p">{</span>
</span><span class="line">        download.file<span class="p">(</span>url<span class="p">,</span> fileName<span class="p">,</span> quiet <span class="o">=</span> <span class="k-Variable">T</span><span class="p">)</span>
</span><span class="line">      <span class="p">}</span>
</span><span class="line">      zceData <span class="o">&lt;-</span> read.table<span class="p">(</span>fileName<span class="p">,</span> header <span class="o">=</span> <span class="k-Variable">F</span><span class="p">,</span> skip <span class="o">=</span> <span class="m">1</span><span class="p">,</span> sep <span class="o">=</span> <span class="s">&quot;,&quot;</span><span class="p">,</span> col.names <span class="o">=</span> colnames<span class="p">)</span>
</span><span class="line">      zceData <span class="o">&lt;-</span> zceData<span class="p">[(</span>zceData<span class="p">[,</span> <span class="m">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&quot;小计&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span>zceData<span class="p">[,</span> <span class="m">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&quot;总计&quot;</span><span class="p">),</span> <span class="p">]</span>
</span><span class="line">      zceData<span class="p">$</span>date <span class="o">&lt;-</span> date
</span><span class="line">      zceDatabase <span class="o">&lt;-</span> rbind<span class="p">(</span>zceDatabase<span class="p">,</span> zceData<span class="p">)</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">  <span class="p">}</span>
</span><span class="line">  <span class="kr">return</span><span class="p">(</span>zceDatabase<span class="p">)</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>但是查询2009年及之前的数据返回的是网页形式，那就需要从网页上读取。</p>

<p>看下面几个链接</p>

<ul>
  <li><a href="http://www.czce.com.cn/portal/exchange/jyxx/hq/hq20060106.html">http://www.czce.com.cn/portal/exchange/jyxx/hq/hq20060106.html</a></li>
  <li><a href="http://www.czce.com.cn/portal/exchange/jyxx/hq/hq20070104.html">http://www.czce.com.cn/portal/exchange/jyxx/hq/hq20070104.html</a></li>
  <li><a href="http://www.czce.com.cn/portal/exchange/jyxx/hq/hq20080104.html">http://www.czce.com.cn/portal/exchange/jyxx/hq/hq20080104.html</a></li>
  <li><a href="http://www.czce.com.cn/portal/exchange/jyxx/hq/hq20090105.html">http://www.czce.com.cn/portal/exchange/jyxx/hq/hq20090105.html</a></li>
</ul>

<p>网页格式很统一，数据在被table标签包裹，并且是在第二个table标签中，XML包的<code>readHTMLTable</code>函数可以读取table标签中的内容，但是当网页中有汉字的时候，汉字会变成乱码，慎用！</p>

<p>不过，本文的情况有点特殊，汉字只出现在table的第一行表头，以及“小计”、“总计”的行，这些行本来就是要去掉的，所以对我们没影响。</p>

<p>下面只给出关键代码：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span /></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="r"><span class="line">require<span class="p">(</span>XML<span class="p">)</span>
</span><span class="line">require<span class="p">(</span>stringr<span class="p">)</span>
</span><span class="line">url <span class="o">&lt;-</span> <span class="s">&quot;http://www.czce.com.cn/portal/exchange/jyxx/hq/hq20060106.html&quot;</span>
</span><span class="line">tb <span class="o">&lt;-</span>readHTMLTable<span class="p">(</span>url<span class="p">)[[</span><span class="m">2</span><span class="p">]]</span>
</span><span class="line">tb <span class="o">&lt;-</span> sapply<span class="p">(</span>tb<span class="p">,</span>str_trim<span class="p">)</span>
</span><span class="line">df <span class="o">&lt;-</span>as.data.frame<span class="p">(</span>apply<span class="p">(</span>tb<span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="kr">function</span><span class="p">(</span>x<span class="p">)</span> iconv<span class="p">(</span>x<span class="p">,</span> from <span class="o">=</span> <span class="s">&quot;gb2312&quot;</span><span class="p">,</span> to <span class="o">=</span> <span class="s">&quot;UTF-8&quot;</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>再把第一列为NA的行去除就行了。</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[用R获取大连商品交易所历史数据]]></title>
    <link href="http://yanping.me/cn/blog/2012/12/09/get-dce-data/"/>
    <updated>2012-12-09T20:00:00+08:00</updated>
    <id>http://yanping.me/cn/blog/2012/12/09/get-dce-data</id>
    <content type="html"><![CDATA[<p class="info">本文主要讨论如何用R语言从大连商品交易所网站上获取期货合约交易数据</p>

<p>大商所的网站上有提供查询历史的<a href="http://www.dce.com.cn/portal/cate?cid=1261730308135">页面</a>。但是它只能对某一个品种查询某一天的报价，或者某一天所有品种的报价，如果我想批量获取交易数据，应该怎么做呢？</p>

<p>首先剖析一下这个页面，用firefox的firebug查看日行情表的代码</p>

<p><img src="http://i.imgur.com/PFZ4f1k.png" alt="日行情表" /></p>

<p>可以看到，这个表实际上是用iframe实现的，查看页面的源文件可以查出这个iframe引用页面地址为<a href="http://www.dce.com.cn/PublicWeb/MainServlet?action=Data_service">http://www.dce.com.cn/PublicWeb/MainServlet?action=Data_service</a>。用上面的方法继续剖析这个页面，发现它引用了<a href="http://www.dce.com.cn/PublicWeb/MainServlet?action=Pu00011_search">http://www.dce.com.cn/PublicWeb/MainServlet?action=Pu00011_search</a>。</p>

<!--more-->

<p>先忽略无关的代码，只关注下面这部分</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span /></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
<span class="line-number">38</span>
<span class="line-number">39</span>
<span class="line-number">40</span>
<span class="line-number">41</span>
<span class="line-number">42</span>
<span class="line-number">43</span>
<span class="line-number">44</span>
<span class="line-number">45</span>
<span class="line-number">46</span>
<span class="line-number">47</span>
<span class="line-number">48</span>
<span class="line-number">49</span>
<span class="line-number">50</span>
<span class="line-number">51</span>
<span class="line-number">52</span>
<span class="line-number">53</span>
<span class="line-number">54</span>
<span class="line-number">55</span>
<span class="line-number">56</span>
<span class="line-number">57</span>
</pre></td><td class="code"><pre><code class="html"><span class="line"><span class="nt">&lt;form</span> <span class="na">target=</span><span class="s">&quot;_blank&quot;</span> <span class="na">name=</span><span class="s">&quot;form1&quot;</span> <span class="na">action=</span><span class="s">&quot;/PublicWeb/MainServlet&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span> <span class="na">onSubmit=</span><span class="s">&quot;return formcheck(this);&quot;</span><span class="nt">&gt;</span>
</span><span class="line">  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name=</span><span class="s">&quot;action&quot;</span> <span class="na">value=</span><span class="s">&quot;Pu00011_result&quot;</span><span class="nt">&gt;</span>
</span><span class="line"><span class="nt">&lt;tr</span> <span class="na">valign=</span><span class="s">&quot;top&quot;</span><span class="nt">&gt;</span>
</span><span class="line"><span class="nt">&lt;td</span> <span class="na">height=</span><span class="s">&quot;10&quot;</span><span class="nt">&gt;&lt;/td&gt;</span>
</span><span class="line"><span class="nt">&lt;/tr&gt;</span>
</span><span class="line">  <span class="nt">&lt;tr</span> <span class="na">valign=</span><span class="s">&quot;top&quot;</span><span class="nt">&gt;</span>
</span><span class="line">    <span class="nt">&lt;td</span> <span class="na">height=</span><span class="s">&quot;133&quot;</span><span class="nt">&gt;</span>
</span><span class="line">	<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;title&quot;</span><span class="nt">&gt;</span>日 行 情 表<span class="nt">&lt;/div&gt;</span>
</span><span class="line"><span class="nt">&lt;table</span> <span class="na">border=</span><span class="s">&quot;0&quot;</span> <span class="na">align=</span><span class="s">&quot;center&quot;</span> <span class="na">cellpadding=</span><span class="s">&quot;3&quot;</span> <span class="na">cellspacing=</span><span class="s">&quot;1&quot;</span> <span class="na">width=</span><span class="s">&quot;97%&quot;</span><span class="nt">&gt;</span>
</span><span class="line">  <span class="nt">&lt;tr&gt;</span>
</span><span class="line">    <span class="nt">&lt;td</span> <span class="na">class=</span><span class="s">&quot;nametd&quot;</span><span class="nt">&gt;</span> 查询日期:<span class="nt">&lt;/td&gt;</span>
</span><span class="line">    <span class="nt">&lt;td</span> <span class="na">class=</span><span class="s">&quot;tdjian&quot;</span> <span class="nt">&gt;&lt;input</span> <span class="na">name=</span><span class="s">&quot;Pu00011_Input.trade_date&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">size=</span><span class="s">&quot;8&quot;</span> <span class="na">maxlength=</span><span class="s">&quot;8&quot;</span><span class="nt">&gt;</span>
</span><span class="line">      <span class="nt">&lt;img</span>  <span class="na">align=</span><span class="s">&quot;absmiddle&quot;</span> <span class="na">src=</span><span class="s">&quot;/PublicWeb/include/images/calendar/show.gif&quot;</span> <span class="na">id=</span><span class="s">&quot;Pu00011_Input.trade_date.img&quot;</span> <span class="na">onClick=</span><span class="s">&#39;swapCalendar(document.all(&quot;Pu00011_Input.trade_date&quot;))&#39;</span> <span class="na">valign=</span><span class="s">&quot;bottom&quot;</span><span class="nt">&gt;</span>
</span><span class="line">    <span class="nt">&lt;/td&gt;</span>
</span><span class="line">    <span class="nt">&lt;td</span> <span class="na">class=</span><span class="s">&quot;nametd&quot;</span><span class="nt">&gt;</span> 品　　种:<span class="nt">&lt;/td&gt;</span>
</span><span class="line">    <span class="nt">&lt;td</span> <span class="na">class=</span><span class="s">&quot;tdjian&quot;</span><span class="nt">&gt;&lt;select</span> <span class="na">name=</span><span class="s">&quot;Pu00011_Input.variety&quot;</span><span class="nt">&gt;</span>
</span><span class="line">      <span class="nt">&lt;option</span> <span class="na">selected</span> <span class="na">value=</span><span class="s">&quot;all&quot;</span><span class="nt">&gt;</span>全部<span class="nt">&lt;/option&gt;</span>
</span><span class="line">      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">&quot;a&quot;</span><span class="nt">&gt;</span>豆一<span class="nt">&lt;/option&gt;</span>
</span><span class="line">      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">&quot;b&quot;</span><span class="nt">&gt;</span>豆二<span class="nt">&lt;/option&gt;</span>
</span><span class="line">      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">&quot;c&quot;</span><span class="nt">&gt;</span>玉米<span class="nt">&lt;/option&gt;</span>
</span><span class="line">      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">&quot;j&quot;</span><span class="nt">&gt;</span>焦炭<span class="nt">&lt;/option&gt;</span>
</span><span class="line">      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">&quot;l&quot;</span><span class="nt">&gt;</span>聚乙烯<span class="nt">&lt;/option&gt;</span>
</span><span class="line">      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">&quot;m&quot;</span><span class="nt">&gt;</span>豆粕<span class="nt">&lt;/option&gt;</span>
</span><span class="line">      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">&quot;p&quot;</span><span class="nt">&gt;</span>棕榈油<span class="nt">&lt;/option&gt;</span>
</span><span class="line">      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">&quot;v&quot;</span><span class="nt">&gt;</span>聚氯乙烯<span class="nt">&lt;/option&gt;</span>
</span><span class="line">      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">&quot;y&quot;</span><span class="nt">&gt;</span>豆油<span class="nt">&lt;/option&gt;</span>
</span><span class="line">      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">&quot;s&quot;</span><span class="nt">&gt;</span>大豆<span class="nt">&lt;/option&gt;</span>
</span><span class="line">    <span class="nt">&lt;/select&gt;&lt;/td&gt;</span>
</span><span class="line">  <span class="nt">&lt;/tr&gt;</span>
</span><span class="line">  <span class="nt">&lt;tr&gt;</span>
</span><span class="line">    <span class="nt">&lt;td</span> <span class="na">class=</span><span class="s">&quot;nametd&quot;</span><span class="nt">&gt;</span> <span class="nt">&lt;p&gt;</span> 行情类型:<span class="nt">&lt;/p&gt;</span>      <span class="nt">&lt;/td&gt;</span>
</span><span class="line">    <span class="nt">&lt;td</span> <span class="na">class=</span><span class="s">&quot;tdjian&quot;</span> <span class="na">colspan=</span><span class="s">&quot;3&quot;</span><span class="nt">&gt;</span> <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">&quot;Pu00011_Input.trade_type&quot;</span> <span class="na">type=</span><span class="s">&quot;radio&quot;</span> <span class="na">value=</span><span class="s">&quot;0&quot;</span> <span class="na">checked</span><span class="nt">&gt;</span>期货行情
</span><span class="line">    <span class="c">&lt;!--hide option</span>
</span><span class="line"><span class="c">      &lt;input name=&quot;Pu00011_Input.trade_type&quot; type=&quot;radio&quot; value=&quot;1&quot;&gt;期权行情</span>
</span><span class="line"><span class="c">     --&gt;</span>
</span><span class="line">    <span class="nt">&lt;/td&gt;</span>
</span><span class="line">  <span class="nt">&lt;/tr&gt;</span>
</span><span class="line"><span class="nt">&lt;/table&gt;</span>
</span><span class="line"><span class="nt">&lt;script </span><span class="na">language=</span><span class="s">&quot;javascript&quot;</span><span class="nt">&gt;</span>
</span><span class="line"> <span class="nx">calendarImages</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;/PublicWeb/include/images/calendar/prev_year.gif&quot;</span><span class="p">,</span> <span class="s2">&quot;/PublicWeb/include/images/calendar/prev_month.gif&quot;</span><span class="p">,</span> <span class="s2">&quot;/PublicWeb/include/images/calendar/next_month.gif&quot;</span><span class="p">,</span> <span class="s2">&quot;/PublicWeb/include/images/calendar/next_year.gif&quot;</span><span class="p">,</span> <span class="s2">&quot;/PublicWeb/include/images/calendar/show.gif&quot;</span><span class="p">,</span> <span class="s2">&quot;/PublicWeb/include/images/calendar/hide.gif&quot;</span><span class="p">]</span>
</span><span class="line">  <span class="nx">getCalendar</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">all</span><span class="p">(</span><span class="s2">&quot;Pu00011_Input.trade_date&quot;</span><span class="p">),</span> <span class="s1">&#39;20130208&#39;</span><span class="p">);</span>
</span><span class="line"><span class="nt">&lt;/script&gt;</span>
</span><span class="line"><span class="nt">&lt;table</span> <span class="na">border=</span><span class="s">&quot;0&quot;</span> <span class="na">align=</span><span class="s">&quot;center&quot;</span> <span class="na">cellpadding=</span><span class="s">&quot;5&quot;</span> <span class="na">cellspacing=</span><span class="s">&quot;0&quot;</span><span class="nt">&gt;</span>
</span><span class="line">  <span class="nt">&lt;tr&gt;</span>
</span><span class="line">    <span class="nt">&lt;td&gt;&lt;input</span> <span class="na">name=</span><span class="s">&quot;Submit&quot;</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">class=</span><span class="s">&quot;button&quot;</span> <span class="na">value=</span><span class="s">&quot;查 询&quot;</span> <span class="na">onClick=</span><span class="s">&quot;document.form1.action.value=&#39;Pu00011_result&#39;;document.form1.target=&#39;_blank&#39;;&quot;</span><span class="nt">&gt;</span><span class="ni">&amp;nbsp;&amp;nbsp;</span><span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">&quot;Submit2&quot;</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">class=</span><span class="s">&quot;downbutton&quot;</span> <span class="na">value=</span><span class="s">&quot;下载文本格式&quot;</span> <span class="na">onClick=</span><span class="s">&quot;document.form1.action.value=&#39;Pu00012_download&#39;;document.form1.target=&#39;_self&#39;;&quot;</span><span class="nt">&gt;</span><span class="ni">&amp;nbsp;&amp;nbsp;</span><span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">&quot;Submit2&quot;</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">class=</span><span class="s">&quot;button&quot;</span> <span class="na">value=</span><span class="s">&quot;打 印&quot;</span> <span class="na">onClick=</span><span class="s">&quot;document.form1.action.value=&#39;Pu00011_result&#39;;document.form1.target=&#39;_blank&#39;;&quot;</span><span class="nt">&gt;&lt;/td&gt;</span>
</span><span class="line">  <span class="nt">&lt;/tr&gt;</span>
</span><span class="line"><span class="nt">&lt;/table&gt;</span>
</span><span class="line"><span class="nt">&lt;table</span> <span class="na">border=</span><span class="s">&quot;0&quot;</span> <span class="na">align=</span><span class="s">&quot;center&quot;</span> <span class="na">cellpadding=</span><span class="s">&quot;1&quot;</span> <span class="na">cellspacing=</span><span class="s">&quot;0&quot;</span> <span class="na">width=</span><span class="s">&quot;97%&quot;</span><span class="nt">&gt;</span>
</span><span class="line">  <span class="nt">&lt;tr</span> <span class="na">align=</span><span class="s">&quot;left&quot;</span><span class="nt">&gt;</span>
</span><span class="line">    <span class="nt">&lt;td</span> <span class="na">width=</span><span class="s">20</span> <span class="na">valign=</span><span class="s">top</span><span class="nt">&gt;</span>注：<span class="nt">&lt;/td&gt;</span>
</span><span class="line">    <span class="nt">&lt;td&gt;</span>
</span><span class="line">     日行情信息 在每日“结算后”发布。历史数据始自2000-05-08。
</span><span class="line">    <span class="nt">&lt;/td&gt;</span>
</span><span class="line">  <span class="nt">&lt;/tr&gt;</span>
</span><span class="line"><span class="nt">&lt;/table&gt;</span>
</span><span class="line">
</span><span class="line">  <span class="nt">&lt;/form&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>要看懂上面的代码需要点网络编程的知识，请参考w3shool上关于<a href="http://www.w3school.com.cn/tags/tag_form.asp">form标签</a>、<a href="http://www.w3school.com.cn/tags/tag_select.asp">select标签</a>、<a href="http://www.w3school.com.cn/tags/tag_input.asp">input标签</a>以及<a href="http://www.w3school.com.cn/htmldom/event_onclick.asp">onClick事件</a>的介绍。</p>

<p>简单地说上面代码做了以下几件事：</p>

<ul>
  <li>整段代码定义了个表单，名为form1，用于向服务器传输数据，后面用input标签和select标签来定义传递的数据</li>
  <li>用了一个input标签和onClick事件<code>onClick='swapCalendar(document.all("Pu00011_Input.trade_date"))'</code>来设置要查询的日期<code>Pu00011_Input.trade_date</code>。</li>
  <li>用了一个select标签来选择查询的品种<code>Pu00011_Input.variety</code></li>
  <li>用了一个input标签来设置行情类型<code>Pu00011_Input.trade_type</code>，从代码里看，<code>Pu00011_Input.trade_type</code>的值始终是0,代表期货行情;从下面注释掉的部分代码可以看出当<code>Pu00011_Input.trade_type</code>取0时，代表的是期权行情，估计网站还没实现这个功能</li>
  <li>然后有一排三个button属性的input标签，所以它们是按钮形式的，并且都有onClick属性，当按下按钮时，会触发javascript脚本，脚本会设置action的值，比如“下载文本格式”这个按钮，按下它会把action的值设置成<code>Pu00012_download</code></li>
</ul>

<p>form向服务器传递数据，其实可以等价于用url地址传递参数。比如日期选择了2012年12月6日，品种选择了“豆一”，点击“下载文本格式”，那么对应的地址为<a href="http://www.dce.com.cn/PublicWeb/MainServlet?Pu00011_Input.trade_date=20121206&amp;Pu00011_Input.trade_type=0&amp;Pu00011_Input.variety=a&amp;action=Pu00012_download">http://www.dce.com.cn/PublicWeb/MainServlet?Pu00011_Input.trade_date=20121206&amp;Pu00011_Input.trade_type=0&amp;Pu00011_Input.variety=a&amp;action=Pu00012_download</a></p>

<p>把地址复制到地址栏，就可以下载文本格式数据了。</p>

<p>那么用R来读取数据的原理就是生成所需数据的url地址，然后用R读取，再经过整理，返回最终数据框。</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span> (dce.r)</span> <a href="http://yanping.me/cn/downloads/code/dce.r">download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
<span class="line-number">38</span>
<span class="line-number">39</span>
<span class="line-number">40</span>
<span class="line-number">41</span>
<span class="line-number">42</span>
<span class="line-number">43</span>
</pre></td><td class="code"><pre><code class="r"><span class="line"><span class="c1"># 从大连商品交易所网站抓取价格数据 数据源</span>
</span><span class="line"><span class="c1"># http://www.dce.com.cn/PublicWeb/MainServlet?action=Pu00011_search</span>
</span><span class="line"><span class="c1"># Pu00011_Input.trade_date ： 查询的日期 </span>
</span><span class="line"><span class="c1"># Pu00011_Input.trade_type ： 行情类别   0为期货，1为期权（未开通） </span>
</span><span class="line"><span class="c1"># Pu00011_Input.variety ：期货品种代码，各代码表示的期货品种： </span>
</span><span class="line"><span class="c1">#  all : 全部 a ： 豆一 b ： 豆二 c ： 玉米 j ：焦炭 l： 聚乙烯 </span>
</span><span class="line"><span class="c1">#  m ： 豆粕 p ： 棕榈油 v ： 聚氯乙烯 y ： 豆油 s ： 大豆</span>
</span><span class="line">
</span><span class="line">
</span><span class="line">getDceData <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>dates<span class="p">,</span> contracts<span class="p">,</span> keep.dataFile <span class="o">=</span> <span class="k-Variable">T</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">  dceDatabase <span class="o">&lt;-</span> data.frame<span class="p">()</span>
</span><span class="line">  <span class="kr">for</span> <span class="p">(</span>date in dates<span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="kr">for</span> <span class="p">(</span>type in contracts<span class="p">)</span> <span class="p">{</span>
</span><span class="line">
</span><span class="line">      str1 <span class="o">&lt;-</span> <span class="s">&quot;http://www.dce.com.cn/PublicWeb/MainServlet?Pu00011_Input.trade_date=&quot;</span>
</span><span class="line">      str2 <span class="o">&lt;-</span> <span class="s">&quot;&amp;Pu00011_Input.trade_type=0&amp;Pu00011_Input.variety=&quot;</span>
</span><span class="line">      str3 <span class="o">&lt;-</span> <span class="s">&quot;&amp;action=Pu00012_download&quot;</span>
</span><span class="line">
</span><span class="line">      url <span class="o">&lt;-</span> paste<span class="p">(</span>str1<span class="p">,</span> date<span class="p">,</span> str2<span class="p">,</span> type<span class="p">,</span> str3<span class="p">,</span> sep <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
</span><span class="line">      fileName <span class="o">&lt;-</span> paste<span class="p">(</span><span class="s">&quot;dce.&quot;</span><span class="p">,</span> type<span class="p">,</span> date<span class="p">,</span> <span class="s">&quot;.txt&quot;</span><span class="p">,</span> sep <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
</span><span class="line">      lines <span class="o">&lt;-</span> readLines<span class="p">(</span>url<span class="p">)</span>
</span><span class="line">      <span class="c1"># 如果使用的是linux系统，就转换lines的编码</span>
</span><span class="line">      <span class="kr">if</span> <span class="p">(</span>sessionInfo<span class="p">()$</span>R.version<span class="p">$</span>os <span class="o">==</span> <span class="s">&quot;linux-gnu&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">        lines <span class="o">&lt;-</span> iconv<span class="p">(</span>lines<span class="p">,</span> from <span class="o">=</span> <span class="s">&quot;gb2312&quot;</span><span class="p">,</span> to <span class="o">=</span> <span class="s">&quot;UTF-8&quot;</span><span class="p">)</span>
</span><span class="line">      <span class="p">}</span>
</span><span class="line">      <span class="c1"># 当输入的日期不是交易日或数据文件里合约数据为空时跳过本次循环</span>
</span><span class="line">      <span class="kr">if</span> <span class="p">(</span>any<span class="p">(</span>lines <span class="o">==</span> <span class="s">&quot;&lt;html&gt;&quot;</span><span class="p">)</span> <span class="o">|</span> length<span class="p">(</span>lines<span class="p">)</span> <span class="o">==</span> <span class="m">5</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">        next
</span><span class="line">      <span class="p">}</span> <span class="kr">else</span> <span class="p">{</span>
</span><span class="line">        content <span class="o">&lt;-</span> lines<span class="p">[</span><span class="m">4</span>:<span class="p">(</span>length<span class="p">(</span>lines<span class="p">)</span> <span class="o">-</span> <span class="m">2</span><span class="p">)]</span>
</span><span class="line">        writeLines<span class="p">(</span>content<span class="p">,</span> fileName<span class="p">)</span>
</span><span class="line">        data <span class="o">&lt;-</span> read.table<span class="p">(</span>fileName<span class="p">,</span> header <span class="o">=</span> <span class="k-Variable">T</span><span class="p">,</span> na.strings <span class="o">=</span> <span class="s">&quot;-&quot;</span><span class="p">)</span>
</span><span class="line">        <span class="kr">if</span> <span class="p">(</span>!keep.dataFile<span class="p">)</span> <span class="p">{</span>
</span><span class="line">          file.remove<span class="p">(</span>fileName<span class="p">)</span>
</span><span class="line">        <span class="p">}</span>
</span><span class="line">        data<span class="p">$</span>date <span class="o">&lt;-</span> date
</span><span class="line">        dceDatabase <span class="o">&lt;-</span> rbind<span class="p">(</span>dceDatabase<span class="p">,</span> data<span class="p">)</span>
</span><span class="line">      <span class="p">}</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">  <span class="p">}</span>
</span><span class="line">  <span class="kr">return</span><span class="p">(</span>dceDatabase<span class="p">)</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>调用举例：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span /></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="r"><span class="line">source<span class="p">(</span><span class="s">&quot;dce.r&quot;</span><span class="p">)</span>
</span><span class="line">d1 <span class="o">&lt;-</span> getDceData<span class="p">(</span><span class="s">&quot;20121206&quot;</span><span class="p">,</span><span class="s">&quot;a&quot;</span><span class="p">)</span>
</span><span class="line">d2 <span class="o">&lt;-</span> getDceData<span class="p">(</span>c<span class="p">(</span><span class="s">&quot;20121204&quot;</span><span class="p">,</span><span class="s">&quot;20121205&quot;</span><span class="p">,</span><span class="s">&quot;20121206&quot;</span><span class="p">),</span> c<span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="s">&quot;b&quot;</span><span class="p">),</span> keep.dataFile <span class="o">=</span> <span class="k-Variable">F</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[用jekyll和jQuery实现异步加载文章列表]]></title>
    <link href="http://yanping.me/cn/blog/2012/10/10/asynchronous-loading-post-list-with-jekyll-and-jQuery/"/>
    <updated>2012-10-10T23:30:00+08:00</updated>
    <id>http://yanping.me/cn/blog/2012/10/10/asynchronous-loading-post-list-with-jekyll-and-jQuery</id>
    <content type="html"><![CDATA[<p class="info">本文主要讨论如何用基于jQuery的插件waypoint，实现异步加载jekyll模板生成的json文件，生成文章列表。</p>

<p>我在<a href="http://art.yanping.me/archives/">另一个博客的文章列表</a>里使用了异步加载的技术，不过直接看页面的html源代码是看不出来的。编译之前的代码在<a href="https://github.com/yanping/art/blob/gh-pages/archives/index.html">这里</a>。</p>

<p>首先，生成文章列表数据的json模板是：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
</pre></td><td class="code"><pre><code class=""><span class="line">---
</span><span class="line">layout: nil
</span><span class="line">---
</span><span class="line">
</span><span class="line">[
</span><span class="line">{% for post in site.posts %}
</span><span class="line">  {"title":"{{post.title}}", 
</span><span class="line">  "url":"{{site.url}}{{post.url}}", 
</span><span class="line">  "date":"{{ post.date | date:'%Y-%m-%d' }}", 
</span><span class="line">  "tags":[{% for tag in post.tags %}"{{tag}}"{% if forloop.last == false %} ,{% endif %}{% endfor %}]}
</span><span class="line">  {% if forloop.last == false %},{% endif %}{% endfor %}
</span><span class="line">]
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>这在前面的<a href="http://chen.yanping.me/cn/blog/2012/04/19/jekyll-with-json/">文章</a>里提到过。</p>

<p>头部YAML数据部分：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span /></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="yaml"><span class="line"><span class="nn">---</span>
</span><span class="line"><span class="l-Scalar-Plain">layout</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">default</span>
</span><span class="line"><span class="l-Scalar-Plain">title</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">全部文章</span>
</span><span class="line"><span class="l-Scalar-Plain">initItem</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">50</span>
</span><span class="line"><span class="l-Scalar-Plain">perPageItem</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">100</span>
</span><span class="line"><span class="nn">---</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p><code>initItem</code>是初始加载时显示的文章主题数，<code>perPageItem</code>是每次页面下拉到底部时读取json数据并新生成的文章主题数。</p>

<p>初始加载网页时，文章主题列表是静态的html，由jekyll生成：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span /></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
</pre></td><td class="code"><pre><code class="html"><span class="line"><span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">&quot;posts&quot;</span><span class="nt">&gt;</span>
</span><span class="line">{% for post in site.posts limit:page.initItem %}
</span><span class="line">  <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">&quot;listing-item&quot;</span><span class="nt">&gt;</span>
</span><span class="line">    <span class="nt">&lt;time</span> <span class="na">datetime=</span><span class="s">&quot;{{ post.date | date:&quot;</span><span class="err">%</span><span class="na">Y-</span><span class="err">%</span><span class="na">m-</span><span class="err">%</span><span class="na">d</span><span class="err">&quot;</span> <span class="err">}}&quot;</span><span class="nt">&gt;</span>{{ post.date | date:&quot;%Y-%m-%d&quot; }}<span class="nt">&lt;/time&gt;</span>
</span><span class="line">    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;{{site.baseurl}}{{ post.url }}&quot;</span> <span class="na">title=</span><span class="s">&quot;{{ post.title }}&quot;</span><span class="nt">&gt;</span>{{ post.title }}<span class="nt">&lt;/a&gt;</span>
</span><span class="line">  <span class="nt">&lt;/li&gt;</span>{% endfor %}
</span><span class="line"><span class="nt">&lt;/ul&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>上面的<code>limit:page.initItem</code>限定了列表的项数不超过<code>initItem</code>。当向下拉页面，waypoint会捕捉到页面下拉到底部的事件，并调用<em>getJSON</em>方法来读取json数据，形成文章列表。</p>

<!--more-->

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span /></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
</pre></td><td class="code"><pre><code class="html"><span class="line">{% if site.posts.size &gt; page.initItem %}
</span><span class="line"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;/js/jquery-1.7.1.min.js&quot;</span> <span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">charset=</span><span class="s">&quot;utf-8&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class="line"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;/js/waypoints.min.js&quot;</span> <span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class="line"><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
</span><span class="line">  <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class="line">    <span class="c1">// 关于waypoint，请看 http://imakewebthings.com/jquery-waypoints/</span>
</span><span class="line">    <span class="kd">var</span> <span class="nx">$loading</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;div class=&#39;loading&#39; style=&#39;text-align:center&#39;&gt;&lt;img src=&#39;/images/loading.gif&#39;&gt;&lt;/div&gt;&quot;</span><span class="p">),</span>
</span><span class="line">    <span class="nx">$footer</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;footer&#39;</span><span class="p">),</span>
</span><span class="line">    <span class="nx">opts</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="line">      <span class="nx">offset</span><span class="o">:</span> <span class="s1">&#39;100%&#39;</span>
</span><span class="line">    <span class="p">};</span>
</span><span class="line">
</span><span class="line">    <span class="kd">var</span> <span class="nx">count</span> <span class="o">=</span> <span class="p">{{</span> <span class="nx">page</span><span class="p">.</span><span class="nx">initItem</span> <span class="p">}};</span> <span class="c1">// 初始文章数</span>
</span><span class="line">    <span class="kd">var</span> <span class="nx">count_sup</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// 循环上界，初始为0</span>
</span><span class="line">    <span class="nx">$footer</span><span class="p">.</span><span class="nx">waypoint</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">direction</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">      <span class="nx">$footer</span><span class="p">.</span><span class="nx">waypoint</span><span class="p">(</span><span class="s1">&#39;remove&#39;</span><span class="p">);</span>
</span><span class="line">      <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.posts&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">$loading</span><span class="p">);</span>
</span><span class="line">      <span class="nx">$</span><span class="p">.</span><span class="nx">getJSON</span><span class="p">(</span><span class="s2">&quot;../post.json&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">        <span class="kd">var</span> <span class="nx">content</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
</span><span class="line">        <span class="nx">count_sup</span> <span class="o">=</span> <span class="nx">count</span> <span class="o">+</span> <span class="p">{{</span> <span class="nx">page</span><span class="p">.</span><span class="nx">perPageItem</span> <span class="p">}};</span> <span class="c1">// 循环上界每次增加page.perPageItem项</span>
</span><span class="line">        <span class="kd">var</span> <span class="nx">delta</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// 局部计数器</span>
</span><span class="line">        <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">          <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&gt;=</span> <span class="nx">count</span> <span class="o">&amp;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">count_sup</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">            <span class="nx">content</span> <span class="o">+=</span> <span class="s2">&quot;&lt;li class=&#39;listing-item&#39;&gt;&lt;time datetime=&#39;&quot;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">date</span> <span class="o">+</span> <span class="s2">&quot;&#39;&gt;&quot;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">date</span> <span class="o">+</span> <span class="s2">&quot;&lt;/time&gt;&quot;</span><span class="p">;</span>
</span><span class="line">            <span class="nx">content</span> <span class="o">+=</span> <span class="s2">&quot;&lt;a href=&#39;&quot;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">url</span> <span class="o">+</span> <span class="s2">&quot;&#39; title=&#39;&quot;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">title</span> <span class="o">+</span> <span class="s2">&quot;&#39;&gt;&quot;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">title</span> <span class="o">+</span> <span class="s2">&quot;&lt;/a&gt;&lt;/li&gt;&quot;</span><span class="p">;</span>
</span><span class="line">            <span class="nx">delta</span><span class="o">++</span><span class="p">;</span>
</span><span class="line">          <span class="p">}</span>
</span><span class="line">        <span class="p">});</span>
</span><span class="line">        <span class="nx">count</span> <span class="o">+=</span> <span class="nx">delta</span><span class="p">;</span>
</span><span class="line">        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;div.loading&#39;</span><span class="p">).</span><span class="nx">remove</span><span class="p">();</span>
</span><span class="line">        <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.posts&quot;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">content</span><span class="p">);</span>
</span><span class="line">        <span class="k">if</span> <span class="p">(</span><span class="nx">count</span> <span class="o">&lt;</span> <span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="nx">$footer</span><span class="p">.</span><span class="nx">waypoint</span><span class="p">(</span><span class="nx">opts</span><span class="p">);</span>
</span><span class="line">      <span class="p">});</span>
</span><span class="line">    <span class="p">},</span> <span class="nx">opts</span><span class="p">);</span>
</span><span class="line">  <span class="p">});</span>
</span><span class="line"><span class="nt">&lt;/script&gt;</span>
</span><span class="line">{% endif %}
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>关于这段代码，要注意以下几点：</p>

<ol>
  <li>上面的代码一开始有个判断语句，当文章数不大于<code>initItem</code>时，后面的js代码不会进入最终生成的html中。</li>
  <li>充分利用Liquid模板的特性，在js代码中，也引用了Liquid模板数据<code>{{ page.initItem }}</code>和<code>{{ page.perPageItem }}</code></li>
  <li><code>.getJSON()</code>读取数据形成列表之后，语句</li>
</ol>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span /></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="html"><span class="line"> if (count <span class="nt">&lt; data</span><span class="err">.</span><span class="na">length</span><span class="err">)</span> <span class="err">$</span><span class="na">footer</span><span class="err">.</span><span class="na">waypoint</span><span class="err">(</span><span class="na">opts</span><span class="err">);</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>是要判断已经加载的文章主题数是否到达总数，如果比总数小，就会在新的底部<code>$footer</code>上注册为<em>waypoint</em>，然后再向下拉页面，到达底部还会触发事件，然后接着读取数据，直到数据已经读取完毕。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[在Windows下使用jekyll如何避免出现中文字符集错误]]></title>
    <link href="http://yanping.me/cn/blog/2012/10/09/chinese-charset-problems-with-jekyll/"/>
    <updated>2012-10-09T21:30:00+08:00</updated>
    <id>http://yanping.me/cn/blog/2012/10/09/chinese-charset-problems-with-jekyll</id>
    <content type="html"><![CDATA[<p class="info">在windows下使用jekyll时经常会遇到字符集错误，比如遇到提示<span style="font-family: Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace;">Liquid error: incompatible character encodings: UTF-8 and GBK</span>。本文将介绍几种解决方案。</p>

<p>1. <strong>修改bash的字符集：</strong>在<code>C:\Documents and Settings\用户名</code>下，找到文件<code>.bash_profile</code>，后面加两行</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span /></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nb">set </span><span class="nv">LC_ALL</span><span class="o">=</span>en_US.UTF-8
</span><span class="line"><span class="nb">set </span><span class="nv">LANG</span><span class="o">=</span>en_US.UTF-8
</span></code></pre></td></tr></table></div></figure></notextile></div>

<!--more-->

<p>2. <strong>所有文档使用utf-8无BOM格式</strong></p>

<p>在Windows下新建的文本文件默认是ANSI格式的，而jekyll只认utf-8。如果遇到ANSI格式编码的文件，可以在notepad++中转换，如下图：</p>

<p><img src="http://f-1.tuzhan.com/31767262cd80/p-1/l/2012/10/09/16/bc35a142ea064af69246d43d794d11bd.png" alt="转换为utf-8编码" /></p>

<p>3. <strong>使用Unix换行符</strong></p>

<p>可以在notepad++中转换，如下图：</p>

<p><img src="http://t-1.tuzhan.com/c6de0d29ca03/p-1/l/2012/10/09/16/73050c832188493ba1d6cbbb4757211c.png" alt="转换为Unix换行符" /></p>

<p>这里有个技巧，在notepad++中，可以开启“显示所有字符”选项，这样就可以看出文档用的是Windows的换行符还是Unix的换行符。</p>

<p><img src="http://f-1.tuzhan.com/63479110599f/p-1/l/2012/10/09/16/6a12be56f7374c608d732f090a1a49bd.png" alt="显示所有字符" /></p>

<p>在这种模式下，Windows的换行符显示的是<code>CR</code>，Unix的换行符显示的是<code>LF</code></p>

<p>4. <strong>新建文档的时候就注意到前两条</strong></p>

<p>在<strong>设置–&gt;首选项</strong>里，如下设置
<img src="http://f-1.tuzhan.com/fb1e112d285c/p-1/l/2012/10/09/21/6c80da6e228343998fa184a3983c403a.png" alt="新建文档设置" /></p>

<p>5. <strong>注意YAML头部的格式</strong></p>

<p>模板文件的元数据以YAML的格式展现，YAML头部经常会出现三个问题：（1）三短线前面不能有空格；（2）“名: 值”对里冒号后面要有空格；（3）回车后不要有Tab符；（4）表示数组成员开始的<code>-</code>号后面要有空格</p>

<p>在notepad++中开启“显示所有字符”选项后，就可以看清空格和Tab符了，下图是很规范的例子
<img src="http://f-1.tuzhan.com/5a62f0e1e6c7/p-1/l/2012/10/09/16/1395a21769e24594a7783da6a8310d17.png" alt="yaml头部" /></p>

<p>尤其是Tab符，不借助工具很难跟空格区分，下图那个向右箭头的符号就是Tab符，这是个错误的例子，应该把Tab符删除，改为用空格缩进</p>

<p><img src="http://f-1.tuzhan.com/104be2300ea4/p-1/l/2012/10/09/16/5a42fd3a016741388044954d4e9c0925.png" alt="带Tab符的YAML头部" /></p>

<p>正确的应该是这样，<code>-</code>号后面都有空格</p>

<p><img src="http://f-1.tuzhan.com/8df6d607c9f0/p-1/l/2012/10/09/16/4769b025fb8b4d129d3755cf84746ad1.png" alt="不带Tab符的YAML头部" /></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[DecisionTools培训课程大纲]]></title>
    <link href="http://yanping.me/cn/blog/2012/06/10/palisade-training-course/"/>
    <updated>2012-06-10T15:00:00+08:00</updated>
    <id>http://yanping.me/cn/blog/2012/06/10/palisade-training-course</id>
    <content type="html"><![CDATA[<p class="info">本人近期将推出《DecisionTools高级应用：数量风险建模与决策分析》课程，有需要培训的团体或个人与我联系。</p>

<h2 id="section">课程目标</h2>
<p>DecisionTools是一套在Microsoft Excel量身定制集成程序，从而使用户可以在一个软件包中针对不确定因素完成风险优化及决策分析的操作。DecisionTools Suite包括使用蒙特卡罗模拟执行风险分析的@RISK、执行决策分析的PrecisionTree和执行灵敏度分析的TopRank。此外，软件还包括执行预测、数据分析和最优化的 StatTools、NeuralTools和Evolver。</p>

<p>本课程适用于从事风险建模、数据分析工作的人员。本课程使用项目成本评估、折现现金流模型等常规案例来讲解蒙特卡罗模拟的思想和软件操作技巧。学员将在课程中学习如何在Excel环境中建立风险评估模型和不确定性条件下的决策模型。</p>

<p>除了@RISK以外，本课程也会介绍DecisionTools套件的其他组件， 这些组件可以完善和补充@RISK的模拟功能。主要涉及的主题包括：</p>

<ul>
  <li>使用PrecisionTree做序列决策建模以及敏感性分析；</li>
  <li>结合@RISK和PrecisionTree；</li>
  <li>使用RISKOptimizer做不确定性优化; </li>
  <li>使用TopRank做敏感性分析；</li>
  <li>使用StatTools和NeuralTools做统计分析和预测</li>
</ul>

<!--more-->

<h2 id="section-1">课程大纲</h2>

<p><strong>第一部分: @RISK和TopRank</strong></p>

<ul>
  <li>概率论、统计学和蒙特卡洛模拟的基础知识</li>
  <li>@RISK的界面介绍</li>
  <li>在确定性模型中加入不确定性</li>
  <li>在风险模型中结合专家意见</li>
  <li>用TopRank做敏感性分析和情景分析</li>
  <li>模拟和模拟设置</li>
  <li>输出与结果分析</li>
  <li>在Excel中报告模拟结果</li>
</ul>

<p><strong>第二部分: @RISK, PrecisionTree, Evolver, RISKOptimizer, StatTools和 NeuralTools</strong></p>

<ul>
  <li>使用离散分布</li>
  <li>建模逻辑</li>
  <li>选择适合的分布</li>
  <li>拟合数据的分布</li>
  <li>使用 @RISK做决策分析</li>
  <li>使用PrecisionTree做决策分析</li>
  <li>使用Evolver和RISKOptimizer做最优化决策</li>
  <li>相关性建模</li>
  <li>使用StatTools和NeuralTools做数据分析</li>
</ul>

<p><strong>第三部分: 案例教学</strong></p>

<p>案例范围有：</p>

<ul>
  <li>公司财务规划</li>
  <li>项目管理</li>
  <li>股票价格与期权定价</li>
  <li>管理利率风险</li>
  <li>期货对冲</li>
  <li>存货与排队论</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[下一步学习的目标]]></title>
    <link href="http://yanping.me/cn/blog/2012/06/07/new-target/"/>
    <updated>2012-06-07T23:58:00+08:00</updated>
    <id>http://yanping.me/cn/blog/2012/06/07/new-target</id>
    <content type="html"><![CDATA[<p>不给自己定太遥远的目标了，为了把R语言捡起来，为了把数量金融方面捡起来，我决定以 <em>Using SAS in Financial Research</em> 为蓝本，用R语言来实现每章的案例，来个 <em>Using R in Financial Research</em> 。涉及的案例有：</p>

<ul>
  <li>资产价格的随机游走理论：方差比率检验</li>
  <li>谁是赢家谁是输家：使用R来检验过度反应假设</li>
  <li>资本资产定价模型的实证检验：使用横截面方法</li>
  <li>事件研究</li>
  <li>价格-盈利关系的分析：关联类型研究方法</li>
  <li>使用财务压力特征模型来预测破产</li>
  <li>使用会计信息来预测市场绩效</li>
  <li>交易数据的分析</li>
</ul>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[用jekyll生成包含json变量的js脚本]]></title>
    <link href="http://yanping.me/cn/blog/2012/04/20/jekyll-with-js-and-json/"/>
    <updated>2012-04-20T23:58:00+08:00</updated>
    <id>http://yanping.me/cn/blog/2012/04/20/jekyll-with-js-and-json</id>
    <content type="html"><![CDATA[<p class="info">本文主要讨论如何用jekyll模板生成含有json数据的javascript脚本，并以此解决跨域读取json数据的问题。</p>

<p><a href="http://yanping.me/cn/blog/2012/04/19/jekyll-with-json/">前一篇文章</a>提到用getJSON读取json文件，并以此动态更新页面，但只能读取同域的json文件，据说是出于安全性的考虑。</p>

<p>现在问题出来了，我除了前文提到的三个网站以外，还有个<a href="http://inwake.com/ypchen">主页的镜像网站</a>，它存放在美国的一位师兄的服务器上，和那三个网站肯定不同域，如果我要让它和github上的<a href="http://yanping.me">主页</a>始终保持一致，又不想每次手动修改博客文章列表，也不能再使用feedsky了。因为feedsky除了慢之外，生成的列表样式也和网站风格不一致。</p>

<!--more-->

<p>别看表面上只有一行代码：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span /></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="html"><span class="line"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;http://feed.feedsky.com/yanping/jsout&amp;n=5&amp;e=utf8&quot;</span> <span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>	
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>实际上经过了向feedsky服务器发送请求、返回数据、浏览器渲染之后的代码很臃肿，用firefox的插件firebug查看上面那行代码渲染之后的代码是如下行形式（只是个例子，等这篇文章发布以后feedsky提供的内容会改变）：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span /></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
<span class="line-number">38</span>
<span class="line-number">39</span>
<span class="line-number">40</span>
<span class="line-number">41</span>
<span class="line-number">42</span>
<span class="line-number">43</span>
<span class="line-number">44</span>
<span class="line-number">45</span>
<span class="line-number">46</span>
<span class="line-number">47</span>
<span class="line-number">48</span>
<span class="line-number">49</span>
</pre></td><td class="code"><pre><code class="html"><span class="line"><span class="c">&lt;!-- Feedsky FEED JS发布代码开始 --&gt;</span>
</span><span class="line">    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;http://feed.feedsky.com/yanping/jsout&amp;amp;n=5&amp;amp;e=utf8&quot;</span><span class="nt">&gt;</span>
</span><span class="line">    <span class="nt">&lt;/script&gt;</span>
</span><span class="line">    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;reader-publisher-module&quot;</span> <span class="na">id=</span><span class="s">&quot;readerpublishermodule0&quot;</span> <span class="na">style=</span><span class="s">&quot;border: 1px solid rgb(188, 204, 235); margin: 0.5em; padding: 0pt; background: rgb(255, 255, 255) none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; text-align: left; text-indent: 0pt; text-decoration: none; font-weight: normal; font-family: arial,sans-serif; font-size: 10pt; -moz-border-radius-topleft: 8px; -moz-border-radius-topright: 8px; -moz-border-radius-bottomright: 8px; -moz-border-radius-bottomleft: 8px;&quot;</span><span class="nt">&gt;</span>
</span><span class="line">        <span class="nt">&lt;h3</span> <span class="na">style=</span><span class="s">&quot;border-style: none none solid; border-color: -moz-use-text-color -moz-use-text-color rgb(188, 204, 235); border-width: medium medium 1px; margin: 0pt 0.5em; padding: 0.2em 0pt; background: transparent none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; text-align: left; text-indent: 0pt; text-decoration: none; font-weight: normal; -moz-border-radius-topleft: 8px; -moz-border-radius-topright: 8px; -moz-border-radius-bottomright: 0pt; -moz-border-radius-bottomleft: 0pt; color: rgb(9, 9, 146);&quot;</span><span class="nt">&gt;</span>
</span><span class="line">            <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://chen.yanping.me/cn/&quot;</span><span class="nt">&gt;</span>
</span><span class="line">                雁起平沙的网络日志
</span><span class="line">            <span class="nt">&lt;/a&gt;</span>
</span><span class="line">        <span class="nt">&lt;/h3&gt;</span>
</span><span class="line">        <span class="nt">&lt;ul</span> <span class="na">style=</span><span class="s">&quot;border: medium none ; margin: 0pt 0.5em; padding: 0.2em; background: transparent none repeat scroll 0%; overflow: hidden; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; text-align: left; text-indent: 0pt; text-decoration: none; font-weight: normal;&quot;</span><span class="nt">&gt;</span>
</span><span class="line">            <span class="nt">&lt;li</span> <span class="na">style=</span><span class="s">&quot;border: medium none ; margin: 0pt; padding: 0.4em 0pt; background: transparent none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; text-align: left; text-indent: 0pt; text-decoration: none; font-weight: normal; list-style-type: none;&quot;</span><span class="nt">&gt;</span>
</span><span class="line">                <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://item.feedsky.com/~feedsky/yanping/~8847833/629496870/6966477/1/item.html&quot;</span>
</span><span class="line">                <span class="na">title=</span><span class="s">&quot;Thu, 19 Apr 2012 22:30:00 +0800:用jekyll生成json&quot;</span> <span class="na">class=</span><span class="s">&quot;i&quot;</span> <span class="na">style=</span><span class="s">&quot;border-style: none none solid; border-color: -moz-use-text-color -moz-use-text-color rgb(122, 126, 224); border-width: medium medium 1px; margin: 0pt; padding: 0pt; background: transparent none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; text-align: left; text-indent: 0pt; text-decoration: none; font-weight: normal; color: rgb(16, 16, 200);&quot;</span><span class="nt">&gt;</span>
</span><span class="line">                    用jekyll生成json
</span><span class="line">                <span class="nt">&lt;/a&gt;</span>
</span><span class="line">            <span class="nt">&lt;/li&gt;</span>
</span><span class="line">            <span class="nt">&lt;li</span> <span class="na">style=</span><span class="s">&quot;border: medium none ; margin: 0pt; padding: 0.4em 0pt; background: transparent none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; text-align: left; text-indent: 0pt; text-decoration: none; font-weight: normal; list-style-type: none;&quot;</span><span class="nt">&gt;</span>
</span><span class="line">                <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://item.feedsky.com/~feedsky/yanping/~8847833/629496871/6966477/1/item.html&quot;</span>
</span><span class="line">                <span class="na">title=</span><span class="s">&quot;Fri, 30 Mar 2012 19:50:00 +0800:指数方法论入门&quot;</span> <span class="na">class=</span><span class="s">&quot;i&quot;</span> <span class="na">style=</span><span class="s">&quot;border-style: none none solid; border-color: -moz-use-text-color -moz-use-text-color rgb(122, 126, 224); border-width: medium medium 1px; margin: 0pt; padding: 0pt; background: transparent none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; text-align: left; text-indent: 0pt; text-decoration: none; font-weight: normal; color: rgb(16, 16, 200);&quot;</span><span class="nt">&gt;</span>
</span><span class="line">                    指数方法论入门
</span><span class="line">                <span class="nt">&lt;/a&gt;</span>
</span><span class="line">            <span class="nt">&lt;/li&gt;</span>
</span><span class="line">            <span class="nt">&lt;li</span> <span class="na">style=</span><span class="s">&quot;border: medium none ; margin: 0pt; padding: 0.4em 0pt; background: transparent none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; text-align: left; text-indent: 0pt; text-decoration: none; font-weight: normal; list-style-type: none;&quot;</span><span class="nt">&gt;</span>
</span><span class="line">                <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://item.feedsky.com/~feedsky/yanping/~8847833/629496872/6966477/1/item.html&quot;</span>
</span><span class="line">                <span class="na">title=</span><span class="s">&quot;Sun, 18 Mar 2012 00:30:00 +0800:Github Pages极简教程&quot;</span> <span class="na">class=</span><span class="s">&quot;i&quot;</span> <span class="na">style=</span><span class="s">&quot;border-style: none none solid; border-color: -moz-use-text-color -moz-use-text-color rgb(122, 126, 224); border-width: medium medium 1px; margin: 0pt; padding: 0pt; background: transparent none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; text-align: left; text-indent: 0pt; text-decoration: none; font-weight: normal; color: rgb(16, 16, 200);&quot;</span><span class="nt">&gt;</span>
</span><span class="line">                    Github Pages极简教程
</span><span class="line">                <span class="nt">&lt;/a&gt;</span>
</span><span class="line">            <span class="nt">&lt;/li&gt;</span>
</span><span class="line">            <span class="nt">&lt;li</span> <span class="na">style=</span><span class="s">&quot;border: medium none ; margin: 0pt; padding: 0.4em 0pt; background: transparent none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; text-align: left; text-indent: 0pt; text-decoration: none; font-weight: normal; list-style-type: none;&quot;</span><span class="nt">&gt;</span>
</span><span class="line">                <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://item.feedsky.com/~feedsky/yanping/~8847833/629496873/6966477/1/item.html&quot;</span>
</span><span class="line">                <span class="na">title=</span><span class="s">&quot;Tue, 13 Mar 2012 00:30:00 +0800:黑魔法利器pandoc&quot;</span> <span class="na">class=</span><span class="s">&quot;i&quot;</span> <span class="na">style=</span><span class="s">&quot;border-style: none none solid; border-color: -moz-use-text-color -moz-use-text-color rgb(122, 126, 224); border-width: medium medium 1px; margin: 0pt; padding: 0pt; background: transparent none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; text-align: left; text-indent: 0pt; text-decoration: none; font-weight: normal; color: rgb(16, 16, 200);&quot;</span><span class="nt">&gt;</span>
</span><span class="line">                    黑魔法利器pandoc
</span><span class="line">                <span class="nt">&lt;/a&gt;</span>
</span><span class="line">            <span class="nt">&lt;/li&gt;</span>
</span><span class="line">            <span class="nt">&lt;li</span> <span class="na">style=</span><span class="s">&quot;border: medium none ; margin: 0pt; padding: 0.4em 0pt; background: transparent none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; text-align: left; text-indent: 0pt; text-decoration: none; font-weight: normal; list-style-type: none;&quot;</span><span class="nt">&gt;</span>
</span><span class="line">                <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://item.feedsky.com/~feedsky/yanping/~8847833/629496874/6966477/1/item.html&quot;</span>
</span><span class="line">                <span class="na">title=</span><span class="s">&quot;Mon, 12 Mar 2012 22:16:00 +0800:我的Octopress样式表&quot;</span> <span class="na">class=</span><span class="s">&quot;i&quot;</span> <span class="na">style=</span><span class="s">&quot;border-style: none none solid; border-color: -moz-use-text-color -moz-use-text-color rgb(122, 126, 224); border-width: medium medium 1px; margin: 0pt; padding: 0pt; background: transparent none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; text-align: left; text-indent: 0pt; text-decoration: none; font-weight: normal; color: rgb(16, 16, 200);&quot;</span><span class="nt">&gt;</span>
</span><span class="line">                    我的Octopress样式表
</span><span class="line">                <span class="nt">&lt;/a&gt;</span>
</span><span class="line">            <span class="nt">&lt;/li&gt;</span>
</span><span class="line">        <span class="nt">&lt;/ul&gt;</span>
</span><span class="line">        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;f&quot;</span> <span class="na">style=</span><span class="s">&quot;border-style: solid none none; border-color: rgb(188, 204, 235) -moz-use-text-color -moz-use-text-color; border-width: 1px medium medium; margin: 0pt; padding: 0.2em 8px; background: rgb(229, 236, 249) none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; text-align: right; text-indent: 0pt; text-decoration: none; font-weight: normal; -moz-border-radius-topleft: 0pt; -moz-border-radius-topright: 0pt; -moz-border-radius-bottomright: 4px; -moz-border-radius-bottomleft: 4px; font-size: small; white-space: nowrap;&quot;</span><span class="nt">&gt;</span>
</span><span class="line">            <span class="nt">&lt;a</span> <span class="na">style=</span><span class="s">&quot;border: medium none ; margin: 0pt; padding: 0pt; background: transparent none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; text-align: left; text-indent: 0pt; text-decoration: underline; font-weight: normal; color: rgb(137, 141, 233);&quot;</span>
</span><span class="line">            <span class="na">href=</span><span class="s">&quot;http://feed.yanping.me&quot;</span><span class="nt">&gt;</span>
</span><span class="line">                Read in Feedsky
</span><span class="line">            <span class="nt">&lt;/a&gt;</span>
</span><span class="line">        <span class="nt">&lt;/div&gt;</span>
</span><span class="line">    <span class="nt">&lt;/div&gt;</span>
</span><span class="line">    <span class="c">&lt;!-- Feedsky FEED JS发布代码结束 --&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>虽然不好跨域读取json数据文件，但是浏览器可以加载外部js脚本，js脚本里又可以包含json变量。</p>

<p>我们称提供json数据的一端为服务端，调用json数据的一端为客户端。在服务端创建下面的js脚本模板：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>recent.json  (posts.js)</span> <a href="http://yanping.me/cn/downloads/code/../../posts.js">download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="o">---</span>
</span><span class="line"><span class="nx">layout</span><span class="o">:</span> <span class="nx">nil</span>
</span><span class="line"><span class="o">---</span>
</span><span class="line">
</span><span class="line"><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class="line">  <span class="kd">var</span> <span class="nx">post</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="line">    <span class="s2">&quot;list&quot;</span><span class="o">:</span> <span class="p">[{</span><span class="o">%</span> <span class="k">for</span> <span class="nx">post</span> <span class="k">in</span> <span class="nx">site</span><span class="p">.</span><span class="nx">posts</span> <span class="nx">limit</span><span class="o">:</span> <span class="mi">5</span> <span class="o">%</span><span class="p">}</span> <span class="p">{</span>
</span><span class="line">      <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;{{post.title}}&quot;</span><span class="p">,</span>
</span><span class="line">      <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;{{site.url}}{{post.url}}&quot;</span><span class="p">,</span>
</span><span class="line">      <span class="s2">&quot;date&quot;</span><span class="o">:</span> <span class="s2">&quot;{{post.date|date_to_string}}&quot;</span>
</span><span class="line">    <span class="p">}</span> <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="nx">forloop</span><span class="p">.</span><span class="nx">last</span> <span class="o">==</span> <span class="kc">false</span> <span class="o">%</span><span class="p">},{</span><span class="o">%</span> <span class="nx">endif</span> <span class="o">%</span><span class="p">}</span> <span class="p">{</span><span class="o">%</span> <span class="nx">endfor</span> <span class="o">%</span><span class="p">}]</span>
</span><span class="line">  <span class="p">};</span>
</span><span class="line">
</span><span class="line">  <span class="kd">var</span> <span class="nx">content</span> <span class="o">=</span> <span class="s2">&quot;&lt;ul class=\&quot;compact recent\&quot;&gt;&quot;</span><span class="p">;</span>
</span><span class="line">  <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">post</span><span class="p">.</span><span class="nx">list</span><span class="p">,</span>
</span><span class="line">  <span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">
</span><span class="line">    <span class="nx">content</span> <span class="o">+=</span> <span class="s2">&quot;&lt;li&gt;&lt;span class=\&quot;date\&quot;&gt;&quot;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">date</span> <span class="o">+</span> <span class="s2">&quot;&lt;/span&gt;&lt;a href=\&quot;&quot;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">url</span> <span class="o">+</span> <span class="s2">&quot;\&quot;&gt;&quot;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">title</span> <span class="o">+</span> <span class="s2">&quot;&lt;/a&gt;&lt;/li&gt;&quot;</span><span class="p">;</span>
</span><span class="line">
</span><span class="line">  <span class="p">});</span>
</span><span class="line">
</span><span class="line">  <span class="nx">content</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/ul&gt;&quot;</span><span class="p">;</span>
</span><span class="line">  <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#blog1-posts-list .loading&quot;</span><span class="p">).</span><span class="nx">remove</span><span class="p">();</span>
</span><span class="line">  <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#blog1-posts-list&quot;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">content</span><span class="p">);</span>
</span><span class="line"><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>经过jekyll的处理后得到：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>recent.json  (posts.js)</span> <a href="http://yanping.me/cn/downloads/code/../../../public/cn/posts.js">download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class="line">  <span class="kd">var</span> <span class="nx">post</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="line">    <span class="s2">&quot;list&quot;</span><span class="o">:</span> <span class="p">[</span> <span class="p">{</span>
</span><span class="line">      <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;关于Github Pages 视频教程&quot;</span><span class="p">,</span>
</span><span class="line">      <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;http://yanping.me/cn/blog/2013/08/12/about-github-pages-step-by-step-video/&quot;</span><span class="p">,</span>
</span><span class="line">      <span class="s2">&quot;date&quot;</span><span class="o">:</span> <span class="s2">&quot;12 Aug 2013&quot;</span>
</span><span class="line">    <span class="p">}</span> <span class="p">,</span>  <span class="p">{</span>
</span><span class="line">      <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;Github Pages 视频教程（1）&quot;</span><span class="p">,</span>
</span><span class="line">      <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;http://yanping.me/cn/blog/2013/08/11/github-pages-step-by-step-video/&quot;</span><span class="p">,</span>
</span><span class="line">      <span class="s2">&quot;date&quot;</span><span class="o">:</span> <span class="s2">&quot;11 Aug 2013&quot;</span>
</span><span class="line">    <span class="p">}</span> <span class="p">,</span>  <span class="p">{</span>
</span><span class="line">      <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;【广告】上海北京两地的R语言培训&quot;</span><span class="p">,</span>
</span><span class="line">      <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;http://yanping.me/cn/blog/2013/06/30/xccds-r-training/&quot;</span><span class="p">,</span>
</span><span class="line">      <span class="s2">&quot;date&quot;</span><span class="o">:</span> <span class="s2">&quot;30 Jun 2013&quot;</span>
</span><span class="line">    <span class="p">}</span> <span class="p">,</span>  <span class="p">{</span>
</span><span class="line">      <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;【译文】软件工程师如何修炼数据科学&quot;</span><span class="p">,</span>
</span><span class="line">      <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;http://yanping.me/cn/blog/2013/05/25/software-engineers-guide-to-getting/&quot;</span><span class="p">,</span>
</span><span class="line">      <span class="s2">&quot;date&quot;</span><span class="o">:</span> <span class="s2">&quot;25 May 2013&quot;</span>
</span><span class="line">    <span class="p">}</span> <span class="p">,</span>  <span class="p">{</span>
</span><span class="line">      <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;《R语言编程艺术》即将上市&quot;</span><span class="p">,</span>
</span><span class="line">      <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;http://yanping.me/cn/blog/2013/05/15/the-art-of-r-programming-published/&quot;</span><span class="p">,</span>
</span><span class="line">      <span class="s2">&quot;date&quot;</span><span class="o">:</span> <span class="s2">&quot;15 May 2013&quot;</span>
</span><span class="line">    <span class="p">}</span>  <span class="p">]</span>
</span><span class="line">  <span class="p">};</span>
</span><span class="line">
</span><span class="line">  <span class="kd">var</span> <span class="nx">content</span> <span class="o">=</span> <span class="s2">&quot;&lt;ul class=\&quot;compact recent\&quot;&gt;&quot;</span><span class="p">;</span>
</span><span class="line">  <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">post</span><span class="p">.</span><span class="nx">list</span><span class="p">,</span>
</span><span class="line">  <span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">
</span><span class="line">    <span class="nx">content</span> <span class="o">+=</span> <span class="s2">&quot;&lt;li&gt;&lt;span class=\&quot;date\&quot;&gt;&quot;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">date</span> <span class="o">+</span> <span class="s2">&quot;&lt;/span&gt;&lt;a href=\&quot;&quot;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">url</span> <span class="o">+</span> <span class="s2">&quot;\&quot;&gt;&quot;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">title</span> <span class="o">+</span> <span class="s2">&quot;&lt;/a&gt;&lt;/li&gt;&quot;</span><span class="p">;</span>
</span><span class="line">
</span><span class="line">  <span class="p">});</span>
</span><span class="line">
</span><span class="line">  <span class="nx">content</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/ul&gt;&quot;</span><span class="p">;</span>
</span><span class="line">  <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#blog1-posts-list .loading&quot;</span><span class="p">).</span><span class="nx">remove</span><span class="p">();</span>
</span><span class="line">  <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#blog1-posts-list&quot;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">content</span><span class="p">);</span>
</span><span class="line"><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>客户端页面里是这样调用的：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span /></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="html"><span class="line"><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;section&quot;</span> <span class="na">id=</span><span class="s">&quot;blog1-posts-list&quot;</span><span class="nt">&gt;</span>
</span><span class="line">	<span class="nt">&lt;h1</span> <span class="na">id=</span><span class="s">&quot;id165&quot;</span><span class="nt">&gt;</span>博客<span class="nt">&lt;/h1&gt;</span>
</span><span class="line">	<span class="nt">&lt;p&gt;</span>我现在主要更新的是托管在github上的<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://chen.yanping.me/cn&quot;</span> <span class="na">target=</span><span class="s">&quot;_blank&quot;</span><span class="nt">&gt;</span>Octopress博客<span class="nt">&lt;/a&gt;</span>，主要记录自己在学习过程中的心得体会。近期内容：<span class="nt">&lt;/p&gt;</span>
</span><span class="line"><span class="nt">&lt;/div&gt;</span>
</span><span class="line">
</span><span class="line"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;http://chen.yanping.me/cn/posts.js&quot;</span> <span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>读者可以自行比较<a href="http://inwake.com/ypchen">http://inwake.com/ypchen</a>和<a href="http://inwake.com/ypchen/json-demo">http://inwake.com/ypchen/json-demo</a>的差别。</p>

<h2 id="section">第二种方法</h2>

<p>上面讲的这种调用方式还是不够灵活，客户端不但提供数据，还限定了使用数据的方法，如果两端你都能操作那一点问题没有，但经常两端分属不同的人维护，你也没权力指挥别人做什么。有没有更好的办法呢？答案是肯定的。只要把数据格式的定义和调用数据的函数定义分开就行。</p>

<p>服务端只定义json数据的形式，例如在博客<a href="https://github.com/yanping/art">https://github.com/yanping/art</a>新建posts2.js的模板：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
</pre></td><td class="code"><pre><code class=""><span class="line">---
</span><span class="line">layout: nil
</span><span class="line">---
</span><span class="line">
</span><span class="line">	var post = {
</span><span class="line">	"list":[{% for post in site.posts limit:5 %}{
</span><span class="line">	    "title":"{{post.title}}",
</span><span class="line">        "url":"{{site.url}}{{post.url}}",
</span><span class="line">        "date":"{{post.date|date_to_string}}"
</span><span class="line">    }{% if forloop.last == false %},{% endif %}
</span><span class="line">	{% endfor %}
</span><span class="line">
</span><span class="line">	]};</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>在客户端页面这样调用：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span /></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
</pre></td><td class="code"><pre><code class="html"><span class="line"><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;section&quot;</span> <span class="na">id=</span><span class="s">&quot;blog2-posts-list&quot;</span><span class="nt">&gt;</span>
</span><span class="line">  <span class="nt">&lt;p&gt;</span>我还有个文艺点儿的<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://art.yanping.me&quot;</span> <span class="na">target=</span><span class="s">&quot;_blank&quot;</span><span class="nt">&gt;</span>博客<span class="nt">&lt;/a&gt;</span>，写写跟技术无关的东西。近期内容：<span class="nt">&lt;/p&gt;</span>
</span><span class="line"><span class="nt">&lt;/div&gt;</span>
</span><span class="line">		
</span><span class="line"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;http://art.yanping.me/posts2.js&quot;</span> <span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class="line">
</span><span class="line"><span class="c">&lt;!-- 下面定义数据调用方法 --&gt;</span>
</span><span class="line"><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
</span><span class="line">  <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class="line">    <span class="kd">var</span> <span class="nx">content</span> <span class="o">=</span><span class="s2">&quot;&lt;ul class=\&quot;compact recent\&quot;&gt;&quot;</span><span class="p">;</span>
</span><span class="line">      <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">post</span><span class="p">.</span><span class="nx">list</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="nx">item</span><span class="p">){</span>
</span><span class="line">        <span class="nx">content</span> <span class="o">+=</span> <span class="s2">&quot;&lt;li&gt;&lt;span class=\&quot;date\&quot;&gt;&quot;</span><span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">date</span> <span class="o">+</span> <span class="s2">&quot;&lt;/span&gt;&lt;a href=\&quot;&quot;</span><span class="o">+</span><span class="nx">item</span><span class="p">.</span><span class="nx">url</span><span class="o">+</span><span class="s2">&quot;\&quot;&gt;&quot;</span><span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">title</span> <span class="o">+</span><span class="s2">&quot;&lt;/a&gt;&lt;/li&gt;&quot;</span><span class="p">;</span>
</span><span class="line">     <span class="p">});</span>
</span><span class="line">
</span><span class="line">  <span class="nx">content</span> <span class="o">+=</span><span class="s2">&quot;&lt;/ul&gt;&quot;</span><span class="p">;</span>
</span><span class="line">  <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#blog2-posts-list&quot;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">content</span><span class="p">);</span>		
</span><span class="line"> <span class="p">});</span>		
</span><span class="line"><span class="nt">&lt;/script&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>我尝试了几种json数据的定义形式，<a href="http://inwake.com/ypchen/json-demo/2.html">示例1</a>、<a href="http://inwake.com/ypchen/json-demo/3.html">示例2</a>、<a href="http://inwake.com/ypchen/json-demo/4.html">示例3</a>和<a href="http://inwake.com/ypchen/json-demo/5.html">示例4</a>，只有最后一种没有办法完成调用，这是因为数据的读取和使用分别在两个<code>&lt;script&gt;</code>标签里，数据必须定义成全局变量才能在后面被引用。</p>

<h2 id="section-1">进一步思考</h2>

<p>在同域的情况下，服务端生成json数据，在客户端用getJSON读取json文件，我们称之为<strong>方法一</strong>，这是<a href="http://yanping.me/cn/blog/2012/04/19/jekyll-with-json/">前一篇文章</a>讲的方法;在跨域的情况下，服务端生成包含json变量的js脚本，然后再在客户端链接这个外部的js脚本，这种方法我们称之为<strong>方法二</strong>。</p>

<p>本文在使用<strong>方法二</strong>时，如果服务端和客户端分别由两个人维护的话，客户端的维护者只能被动接受。幸好我们有github，github的口号是social coding，有人翻译成社会化编程，我偏向于翻译成社交编程。想想我们在facebook、人人网这样的社交网络都干些什么，我们在那上面上发布状态、上传图片，告诉朋友以及路过的陌生人我们都做了什么、心情如何、拍了什么照片，上班时大家很喜欢挂人人，刷新鲜事；而在github上，coder们晒出自己的代码，可以关注别的coder和感兴趣的项目，登录github可以看到大家的“新鲜事”：某某创建了个什么代码库、做了什么修改，你可以亲眼看到别人的项目从最初的雏形发展成一个完美的项目，可以给别人的代码留言，报告bug，也可以fork别人的代码，根据自己的喜好做修改，如果有好的主意，可以给原作者发个pull request，作者要是也同样喜欢，就会加到自己的代码里。</p>

<p>在github上，跨域的问题不是那么难解决，我们完全可以针对自己的需求写个js脚本的模板，给博客的作者发个pull request，或者留言，没准儿哪天包含json变量的js脚本模板也会像rss.xml、atom.xml或者sitemap.xml一样变得成github博客的标配。</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[用jekyll生成json]]></title>
    <link href="http://yanping.me/cn/blog/2012/04/19/jekyll-with-json/"/>
    <updated>2012-04-19T22:30:00+08:00</updated>
    <id>http://yanping.me/cn/blog/2012/04/19/jekyll-with-json</id>
    <content type="html"><![CDATA[<p class="info">本文主要讨论如何用jekyll模板生成json，并以此整合在github上托管的不同网站的数据。</p>

<p>从去年年底接触github和jekyll到现在已经折腾五个月了，从最初用github托管纯静态网站，到现在依照别人的网站构架修改成自己喜欢的样子，这个过程也是个不断学习的过程。</p>

<p>我在github上有三个网站，一个是<a href="http://yanping.me">主页</a>，一个<a href="http://yanping.me/cn">技术博客</a>，最后一个是<a href="http://art.yanping.me">文艺博客</a>。现在有个问题是，这三个网站对应的是github上三个不同的代码库，如果我要在<a href="http://yanping.me">主页</a>上列出另两个网站的文章列表，不能用jekyll提供的函数来做到，jekyll只能操作一个代码库的文本，不能跨代码库。我之前用的一个方法是用feedsky提供的发布脚本，效果请看<a href="http://inwake.com/ypchen/json-demo">http://inwake.com/ypchen/json-demo</a>。这样的缺点是很显然的，一是加载速度慢，二是我们没办法控制列表的格式和样式。有没有更直接的解决方法呢？</p>

<!--more-->

<p>我看到在很多jekyll的博客里，都能自动生成rss.xml和atom.xml，其实说白了，只要是本文文件，jekyll都能用模板操作。后来我听说了json，听说可以用jquery调用json，既然jekyll可以操作本文，那么可不可以用jekyll来生成我们规定格式的json文件呢？例如在<a href="http://yanping.me/cn">技术博客</a>和<a href="http://art.yanping.me">文艺博客</a>各生成一个包含文章信息的json文件，再用jquery或ajax来调用。这里面涉及到一个是否跨域的问题，一开始我只能确定<a href="http://yanping.me">主页</a>和<a href="http://yanping.me/cn">技术博客</a>是同域的，可我忘了<a href="http://art.yanping.me">文艺博客</a>的真正地址是<a href="http://yanping.github.com/art">http://yanping.github.com/art</a>，或者说是<a href="http://chen.yanping.me/art">http://chen.yanping.me/art</a>，<a href="http://art.yanping.me/">http://art.yanping.me/</a>只不过是我后来给它绑定的域名，还特定用了javascript来限定了只能用这个域名访问，因为用前两个地址访问都显示不正常（关于这点，请看<a href="http://chen.yanping.me/cn/blog/2012/02/06/github-pages-domain-3/">这里</a>）。所以说，只要是在同一个github账户下建立的网站，它们就是同域的。</p>

<h2 id="json">生成json</h2>

<p>例如我在网站代码库里建立这样的json文件模板：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>recent.json  (recent.json)</span> <a href="http://yanping.me/cn/downloads/code/../../recent.json">download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="o">---</span>
</span><span class="line"><span class="nx">layout</span><span class="o">:</span> <span class="nx">nil</span>
</span><span class="line"><span class="o">---</span>
</span><span class="line">
</span><span class="line"><span class="p">[{</span><span class="o">%</span> <span class="k">for</span> <span class="nx">post</span> <span class="k">in</span> <span class="nx">site</span><span class="p">.</span><span class="nx">posts</span> <span class="nx">limit</span><span class="o">:</span><span class="mi">5</span> <span class="o">%</span><span class="p">}</span>
</span><span class="line">    <span class="p">{</span>
</span><span class="line">        <span class="s2">&quot;title&quot;</span><span class="o">:</span><span class="s2">&quot;{{post.title}}&quot;</span><span class="p">,</span>
</span><span class="line">        <span class="s2">&quot;url&quot;</span><span class="o">:</span><span class="s2">&quot;{{site.url}}{{post.url}}&quot;</span><span class="p">,</span>
</span><span class="line">        <span class="s2">&quot;date&quot;</span><span class="o">:</span><span class="s2">&quot;{{post.date|date_to_string}}&quot;</span>
</span><span class="line">    <span class="p">}{</span><span class="o">%</span> <span class="k">if</span> <span class="nx">forloop</span><span class="p">.</span><span class="nx">last</span> <span class="o">==</span> <span class="kc">false</span> <span class="o">%</span><span class="p">},{</span><span class="o">%</span> <span class="nx">endif</span> <span class="o">%</span><span class="p">}</span>
</span><span class="line"><span class="p">{</span><span class="o">%</span> <span class="nx">endfor</span> <span class="o">%</span><span class="p">}</span>
</span><span class="line"><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>在使用原生的jekyll时没有问题，但是在使用octopress时就出现了<a href="http://ruby-taiwan.org/topics/230">问题</a>：octopress自动把英文的双引号"变成了<code>&amp;#8220;</code>和<code>&amp;#8221;</code>，经过浏览器的解释对应的是“和”。有人提出在双引号前加<code>\</code>，在网页里的确是显示的原来的引号，但是一看代码，还是字符引用。</p>

<p>昨晚想了很久，网上找资料也没找到，没办法，只好去看octopress里的代码。我可是ruby小白啊，一点都不懂，连猜带蒙终于搞定了。其实最简单粗暴的办法就是把octopress目录下<code>/plugins/octopress_filters.rb</code>里的第19行行首加<code>#</code>注释掉：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span /></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="c1">#		RubyPants.new(input).to_html</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>RubyPants这个插件就是替换引号的元凶，你可以打开它卡看看里面的注释。</p>

<p>经过上面的处理后，octopress也可以正常输出json文件了，请看</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>recent.json  (recent.json)</span> <a href="http://yanping.me/cn/downloads/code/../../../public/cn/recent.json">download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="p">[</span>
</span><span class="line">    <span class="p">{</span>
</span><span class="line">        <span class="s2">&quot;title&quot;</span><span class="o">:</span><span class="s2">&quot;关于Github Pages 视频教程&quot;</span><span class="p">,</span>
</span><span class="line">        <span class="s2">&quot;url&quot;</span><span class="o">:</span><span class="s2">&quot;http://yanping.me/cn/blog/2013/08/12/about-github-pages-step-by-step-video/&quot;</span><span class="p">,</span>
</span><span class="line">        <span class="s2">&quot;date&quot;</span><span class="o">:</span><span class="s2">&quot;12 Aug 2013&quot;</span>
</span><span class="line">    <span class="p">},</span>
</span><span class="line">
</span><span class="line">    <span class="p">{</span>
</span><span class="line">        <span class="s2">&quot;title&quot;</span><span class="o">:</span><span class="s2">&quot;Github Pages 视频教程（1）&quot;</span><span class="p">,</span>
</span><span class="line">        <span class="s2">&quot;url&quot;</span><span class="o">:</span><span class="s2">&quot;http://yanping.me/cn/blog/2013/08/11/github-pages-step-by-step-video/&quot;</span><span class="p">,</span>
</span><span class="line">        <span class="s2">&quot;date&quot;</span><span class="o">:</span><span class="s2">&quot;11 Aug 2013&quot;</span>
</span><span class="line">    <span class="p">},</span>
</span><span class="line">
</span><span class="line">    <span class="p">{</span>
</span><span class="line">        <span class="s2">&quot;title&quot;</span><span class="o">:</span><span class="s2">&quot;【广告】上海北京两地的R语言培训&quot;</span><span class="p">,</span>
</span><span class="line">        <span class="s2">&quot;url&quot;</span><span class="o">:</span><span class="s2">&quot;http://yanping.me/cn/blog/2013/06/30/xccds-r-training/&quot;</span><span class="p">,</span>
</span><span class="line">        <span class="s2">&quot;date&quot;</span><span class="o">:</span><span class="s2">&quot;30 Jun 2013&quot;</span>
</span><span class="line">    <span class="p">},</span>
</span><span class="line">
</span><span class="line">    <span class="p">{</span>
</span><span class="line">        <span class="s2">&quot;title&quot;</span><span class="o">:</span><span class="s2">&quot;【译文】软件工程师如何修炼数据科学&quot;</span><span class="p">,</span>
</span><span class="line">        <span class="s2">&quot;url&quot;</span><span class="o">:</span><span class="s2">&quot;http://yanping.me/cn/blog/2013/05/25/software-engineers-guide-to-getting/&quot;</span><span class="p">,</span>
</span><span class="line">        <span class="s2">&quot;date&quot;</span><span class="o">:</span><span class="s2">&quot;25 May 2013&quot;</span>
</span><span class="line">    <span class="p">},</span>
</span><span class="line">
</span><span class="line">    <span class="p">{</span>
</span><span class="line">        <span class="s2">&quot;title&quot;</span><span class="o">:</span><span class="s2">&quot;《R语言编程艺术》即将上市&quot;</span><span class="p">,</span>
</span><span class="line">        <span class="s2">&quot;url&quot;</span><span class="o">:</span><span class="s2">&quot;http://yanping.me/cn/blog/2013/05/15/the-art-of-r-programming-published/&quot;</span><span class="p">,</span>
</span><span class="line">        <span class="s2">&quot;date&quot;</span><span class="o">:</span><span class="s2">&quot;15 May 2013&quot;</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="json-1">调用json</h2>

<p>可以用ajax或jquery来调用json文件，后者更容易一些，这里给出一个例子，效果见我的<a href="http://yanping.me">主页</a></p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span /></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
</pre></td><td class="code"><pre><code class="html"><span class="line"><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;section&quot;</span> <span class="na">id=</span><span class="s">&quot;blog1-posts-list&quot;</span><span class="nt">&gt;</span>
</span><span class="line">  <span class="nt">&lt;h1</span> <span class="na">id=</span><span class="s">&quot;id165&quot;</span><span class="nt">&gt;</span>博客<span class="nt">&lt;/h1&gt;</span>
</span><span class="line">  <span class="nt">&lt;p&gt;</span>
</span><span class="line">    我现在主要更新的是托管在github上的
</span><span class="line">    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://chen.yanping.me/cn&quot;</span> <span class="na">target=</span><span class="s">&quot;_blank&quot;</span><span class="nt">&gt;</span>Octopress博客<span class="nt">&lt;/a&gt;</span>
</span><span class="line">    ，主要记录自己在学习过程中的心得体会。近期内容：
</span><span class="line">  <span class="nt">&lt;/p&gt;</span>
</span><span class="line"><span class="nt">&lt;/div&gt;</span>
</span><span class="line"><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
</span><span class="line">  <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class="line">    <span class="nx">$</span><span class="p">.</span><span class="nx">getJSON</span><span class="p">(</span><span class="s2">&quot;/cn/recent.json&quot;</span><span class="p">,</span>
</span><span class="line">    <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">      <span class="kd">var</span> <span class="nx">content</span> <span class="o">=</span> <span class="s2">&quot;&lt;ul class=\&quot;compact recent\&quot;&gt;&quot;</span><span class="p">;</span>
</span><span class="line">      <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span>
</span><span class="line">      <span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">
</span><span class="line">        <span class="nx">content</span> <span class="o">+=</span> <span class="s2">&quot;&lt;li&gt;&lt;span class=\&quot;date\&quot;&gt;&quot;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">date</span> <span class="o">+</span> <span class="s2">&quot;&lt;/span&gt;&lt;a href=\&quot;&quot;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">url</span> <span class="o">+</span> <span class="s2">&quot;\&quot;&gt;&quot;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">title</span> <span class="o">+</span> <span class="s2">&quot;&lt;/a&gt;&lt;/li&gt;&quot;</span><span class="p">;</span>
</span><span class="line">
</span><span class="line">      <span class="p">});</span>
</span><span class="line">
</span><span class="line">      <span class="nx">content</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/ul&gt;&quot;</span><span class="p">;</span>
</span><span class="line">      <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#blog1-posts-list&quot;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">content</span><span class="p">);</span>
</span><span class="line">    <span class="p">});</span>
</span><span class="line">  <span class="p">});</span>
</span><span class="line"><span class="nt">&lt;/script&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>别忘了加载jquery脚本，在我主页里是这句：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span /></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="html"><span class="line"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;/files/js/jquery-1.7.1.min.js&quot;</span> <span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[指数方法论入门]]></title>
    <link href="http://yanping.me/cn/blog/2012/03/30/the-abcs-of-index-methodologies/"/>
    <updated>2012-03-30T19:50:00+08:00</updated>
    <id>http://yanping.me/cn/blog/2012/03/30/the-abcs-of-index-methodologies</id>
    <content type="html"><![CDATA[<p class="info">本文译自道琼斯指数公司的<a href="http://blog.djindexes.com">指数学博客</a>，原文地址：<a href="http://blog.djindexes.com/index.php/the-abcs-of-index-methodologies/">http://blog.djindexes.com/index.php/the-abcs-of-index-methodologies/</a></p>

<p>如果我们研究各类市场指数，一个关键的信息来源就是指数的“方法论”。首先，这一文档解释了如何挑选股票（或其它金融工具）进入指数，以及指数是如何计算的。读完指数的方法论，你就会判断出该指数是否精准地度量你想跟踪的市场、资产、策略或者行业板块，也可以了解到该指数对你的实际应用中有多适合。</p>

<p>这些方法论也可以帮助你理解任何引导机制，这些引导机制会适当地使指数在不同的市场环境中保持可靠运行。</p>

<p>下面是你在阅读指数方法论时可能会遇到的术语：</p>

<!--more-->

<p><strong>Universe（样本空间）</strong>：这一术语表示所有可能选入指数的证券或金融工具的集合。例如，包含所有在美国交易所上市交易的股票，或者所有发达国家的主权债务工具。样本空间的定义很宽泛，可能包含上千种证券，即使指数只包含50或者100种证券。</p>

<p><strong>Eligibility Screens（样本筛）</strong>：样本筛允许指数提供商把样本空间缩减到可控的规模，从中去掉那些不合要求的证券。典型的样本筛从股份类别、规模、流动性或基本面等因素筛选。在有些情况下，样本筛将去掉不符指数目的的证券。其它时候，样本筛去掉使ETF或者其它指数连接产品难以复制或者复制成本很高的证券。</p>

<p><strong>Selection Criteria（选样准则）</strong>：结束了筛选过程之后，指数提供商获得了一份合格候选证券的列表。有时，根据指数的目的，选样准则用来进一步精选这份列表，用来寻找“领先”股票，例如，根据规模、流动性或者基本面（虽然潜在准则几乎是无限多的）。合格的证券将会按照选样准则进行排序，排名靠前的证券会被选为指数成分（index components）。</p>

<p><strong>Weighting（加权）</strong>：这一术语表示设定指数成分相对权重的方法。最简单的情况，采用等权重加权，也就是所有的成分对指数的绩效有相等的影响。通常，权益类指数按市值加权，这样股票对指数表现的绩效与它的市值成正比，这里的市值是用股价乘以发行在外的股份数。例如，一种按市值加权的指数，同样是收益5%，市值为100亿美元的成分股对指数的影响是市值为50亿美元的成分股的两倍。其它加权方式包括价格加权和基本面加权，用成分股公司的股价或者基本面数据（例如红利或利润）来加权。</p>

<p><strong>Reconstitution/Rebalancing（调整）</strong>：这个术语描述的指数提供商在何时以及如何调整指数构成和权重。这些调整会帮助指数反映市场的现状，可能是一年一次，也可能一个季度一次，也可能一个月一次，视指数的目的和用途而定。在遇到突发情况时（比如公司发生并购或破产），指数提供商也会在计划之外对指数进行调整。</p>

<p>现在你们有了最基本的概念，过一段时间，我们将会发布一系列文章，更详细讲解这些概念。你们会学到如何构建指数，以及如何根据需要挑选指数。</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Github Pages极简教程]]></title>
    <link href="http://yanping.me/cn/blog/2012/03/18/github-pages-step-by-step/"/>
    <updated>2012-03-18T00:30:00+08:00</updated>
    <id>http://yanping.me/cn/blog/2012/03/18/github-pages-step-by-step</id>
    <content type="html"><![CDATA[<p>我写这篇文章的目的是帮助没有用过gihub和jekyll的童鞋尽快掌握使用流程。学习使用github网页的最好办法就是clone别人的代码，看懂他们的代码，并修改成自己喜欢的样子。这篇文章介绍了从最初安装软件到使用的过程。</p>

<p>先假设读者对ruby完全没有了解，仅对html有初步的了解（<code>&lt;title&gt;</code>等标签知道是什么意思，如果懂点儿CSS更好）。基本的linux命令（<code>ls</code>、<code>cd</code>、<code>mkdir</code>、<code>rm</code>等，不会也没关系，就用到这几个命令，自己百度一下就好）。</p>

<p>本文标题所说的“极简”是基于下面的原则：</p>

<ul>
  <li>安装尽量少的软件</li>
  <li>使用尽量少的命令</li>
  <li>接触尽量少的概念</li>
</ul>

<p>如果想了解用Github Pages写博客的理念，可以看这篇文章</p>

<ul>
  <li><a href="http://www.yangzhiping.com/tech/writing-space.html" target="_blank">《理想的写作环境：git+github+markdown+jekyll》</a></li>
</ul>

<!--more-->

<p>下面开始一步步讲解Github Pages的使用流程：</p>

<p id="git"><strong>一、</strong>如果想在本地预览页面，跳过这步到<a href="#ruby">二</a>；如果不想在本地预览，则在windows下安装<a href="http://code.google.com/p/msysgit/downloads/list" target="_blank">msysgit</a>，最新版本为Git-1.7.9-preview20120201.exe，然后按照<a href="http://beiyuu.com/github-pages/#github" target="_blank">BeiYuu的博文</a>里的过程配置git和github，再到<a href="#install-jekyll">四</a></p>

<p>如果你的系统是linux的，按照<a href="http://help.github.com/linux-set-up-git/" target="_blank">Git Hub官方帮助文件</a>操作，然后跳到<a href="#install-jekyll">四</a>。</p>

<blockquote>
  <p>如果想深入了解Git，请看<a href="http://www.kuqin.com/managetool/20110705/92113.html" target="_blank">10篇写给Git初学者的最佳教程</a>。</p>
</blockquote>

<p id="ruby"><strong>二、在windows下安装ruby环境</strong>。推荐安装<a href="http://railsinstaller.org/" target="_blank">RailsInstaller</a>，里面包含了<a href="http://ruby-lang.org/" target="_blank">Ruby</a>、<a href="http://rubyonrails.org/" target="_blank">Rails</a>、<a href="http://gembundler.com/" target="_blank">Bundler</a>、<a href="http://git-scm.com/" target="_blank">Git</a>、<a href="http://sqlite.org/" target="_blank">Sqlite</a>、<a href="https://github.com/rails-sqlserver/tiny_tds" target="_blank">TinyTDS</a>、<a href="https://github.com/rails-sqlserver/activerecord-sqlserver-adapter" target="_blank">SQL Server support</a>和<a href="https://github.com/oneclick/rubyinstaller/wiki/Development-Kit" target="_blank">DevKit</a>。</p>

<p>不过最近的RailsInstaller里包含的ruby版本升到了1.9.3，如果以后要使用<a href="http://www.octopress.org" target="_blank">Octopress</a>的话必须使用ruby1.9.2，建议使用以前的版本，我把以前的版本放到了<a href="http://inwake.com/ypchen/files/upload/railsinstaller-2.0.1.exe" target="_blank">这里</a>。</p>

<p><strong id="git-hub">三、紧接着上一步，配置git和github</strong></p>

<p>在RailsInstaller安装结束时安装程序会提示是否配置Git环境（这样的话给配置git和github带来极大的方便，又减少了几条命令）。选择”是”，然后出现下面的提示</p>

<p><img src="http://i.imgur.com/321mb.png" alt="git config" class="center" /></p>

<p>填写github注册时的用户名和邮箱，就完成了公钥和密钥的生成，在<code>C:\Documents and Settings\用户名</code>下，有个隐藏目录名为<code>.ssh</code>，id_rsa.pub文件就是公钥，id_rsa就是密钥。</p>

<p>在Github网站找到 “Account Settings” &gt; Click “SSH Keys” &gt; Click “Add SSH key”</p>

<p><img src="https://github-images.s3.amazonaws.com/help/userbar-account-settings.png" alt="set-up-SSH" class="center" /></p>

<p>用文本编辑器打开id_rsa.pub文件，并把里面的内容（包括空格和新行）复制出来，填到Github的账户设置的SSH设置里。</p>

<p><img src="https://github-images.s3.amazonaws.com/help/ssh-key-paste.png" alt="set-up-SSH-2" class="center" /></p>

<p>在开始菜单里找到RailsInstaller –&gt; Git Bash，执行它，就打开了下面的命令窗口，以后的操作都是在这个窗口下进行的</p>

<p><img src="http://i.imgur.com/jnO1n.png" alt="git-bash" class="center" /></p>

<p><strong>注意</strong>: 在窗口里我们可以看到当前路径显示为<code>/c/Sites</code>，其实它表示的是<code>C:\Sites</code>，这个目录是RailsInstaller在安装的时候建的。</p>

<p>用下面的命令测试一下git是否连接正常</p>

<pre><code> ssh -T git@github.com
</code></pre>

<p>想了解普通配置方法的，可进一步阅读：</p>

<ul>
  <li>Github上的<a href="http://help.github.com/set-up-git-redirect" target="_blank">帮助</a></li>
  <li><a href="http://beiyuu.com/github-pages/#github" target="_blank">BeiYuu的博文</a></li>
  <li><a href="http://www.pizn.me/2011/10/02/start-github-on-window.html" target="_blank">window下建立github连接</a></li>
</ul>

<p id="install-jekyll"><strong>四、安装jekyll和相关的包</strong></p>

<p>稍微对配置做一下修改，把淘宝的镜像加到gem的镜像列表里</p>

<pre><code>gem sources --remove http://rubygems.org/
gem sources -a http://ruby.taobao.org/
</code></pre>

<p>然后用<code>gem sources -l</code>看看现在源列表</p>

<pre><code>*** CURRENT SOURCES ***

http://ruby.taobao.org
</code></pre>

<p>如果是上面这样就可以安装jekyll了</p>

<pre><code>gem install jekyll
</code></pre>

<p>Jekyll需要用到directory_watcher、liquid、open4、maruku和classifier这几个包，用上面的命令可以自动安装。Jekyll默认用maruku来解析markdown语言，你也可以用别的程序来解析，比如rdiscount或kramdown，都给装上吧：</p>

<pre><code>gem install rdiscount kramdown
</code></pre>

<p>以上命令涉及到<code>gem install</code>的时候，如果你用的是linux系统，就要用<code>sudo gem install</code>代替。</p>

<p id="gh-pages"><strong>五、建立github pages</strong>。</p>

<p>这一步是本文的重点，也是本文异于网络上其他文章的地方，我在这里用到了Github提供的Github pages generator的功能，减少了使用的命令数量，也绕开了远程代码库这个概念（省略了与git remote相关的操作，不过随着github使用的加深，这些概念也是不能避免的）</p>

<ul>
  <li>在github.com上创建代码库，比如新建一个名为example的代码库：登录到自己的Github账户，选择New repository</li>
</ul>

<p><img src="http://i.imgur.com/V4fSb.png" alt="New repository" class="center" /></p>

<p><img src="http://i.imgur.com/ZOCi9.png" alt="New repository" class="center" /></p>

<p><img src="http://i.imgur.com/5waH7.png" alt="New repository" class="center" /></p>

<ul>
  <li>在线生成pages: 点上图中的Admin</li>
</ul>

<p><img src="http://i.imgur.com/CCND9.png" alt="features" /> </p>

<p><img src="http://i.imgur.com/gi0Ii.png" alt="Automatic GH pages generator" class="center" /></p>

<p>接下来的页面可以不用填，直接点Create Page，马上会转到一个404页面，不要慌，要过一会系统才会帮你把网页生成好。如下图：</p>

<p><img src="http://i.imgur.com/CcGw5.png" alt="Automatic GH pages generator" class="center" /> </p>

<ul>
  <li>
    <p>克隆自己的代码库</p>

    <pre><code>  git clone git@github.com:yanping/example.git
</code></pre>
  </li>
</ul>

<p>这样git会把存放在github上的代码库文件下载到本地的，生成名为example的目录。删除该目录下的index.html，这是系统生成的，不是我想要的页面，注意不要把.git目录删除，这是个隐藏目录，里面包含这个代码库的配置信息，以上的步骤都是为了得到这些配置信息且避免了使用命令。</p>

<p>要注意的几点</p>

<blockquote>
  <ul>
    <li>我的github用户名为yanping，如果我建立名为yanping.github.com的代码库，必须在master分支下的才可以看到页面。在本例中我建的是普通的项目代码库，系统自动生成的github pages是在gh-pages这个分支下的。在以上的操作中，我并没有对分支进行任何操作，都是系统自动完成的。</li>
    <li>创建个人主页面username.github.com的步骤请看<a href="http://www.worldhello.net/gotgithub/03-project-hosting/050-homepage.html#user-homepage" target="_blank">GotGithub教程</a></li>
    <li>git@github.com:yanping/example.git 是example的路径，它的规则是 <strong>git@github.com:用户名/代码库名.git</strong></li>
  </ul>
</blockquote>

<ul>
  <li>
    <p>克隆别人的代码库。在本地另一位置，克隆别人的代码库，比如</p>

    <pre><code>  git clone git@github.com:mojombo/mojombo.github.com.git
</code></pre>
  </li>
</ul>

<p>删掉.git目录，然后把文件都复制到自己的本地代码库example下</p>

<ul>
  <li>
    <p>删除_post下的文件（可保留一两篇作为模板），修改example里的文件，尤其是配置信息，比如_config.yml、disqus的配置，CNAME文件等，更进一步，按照自己的喜好修改网页的布局和样式，这些都可在后期慢慢摸索。然后执行下面的操作</p>

    <ul>
      <li><code>git add .</code>表示添加当前目录下的所有文件</li>
      <li><code>git commit -am "message"</code> 表示提交所有更改，这是提交到本地，”message” 换成自己的注释信息</li>
      <li><code>git push</code> 把在本地的更改提交到远程服务器</li>
    </ul>
  </li>
</ul>

<p>要写博客的时候，在_post里新建一个markdown文件，文件名和文件里面的头部信息（学名叫YAML front matter）按照模板的格式改，编辑好内容后，再依次执行上面三条命令。</p>

<p>如果你不熟悉markdown语法，请看<a href="http://wowubuntu.com/markdown/" target="_blank">这里</a>。</p>

<p>进一步阅读:</p>

<ul>
  <li>Github Pages的<a href="http://pages.github.com/" target="_blank">官方说明文件</a></li>
  <li><a href="https://github.com/mojombo/jekyll/wiki/sites">jekyll主页上提供的示例网站</a>，可以clone他们的网站折腾一翻</li>
  <li><a href="http://www.pizn.me/2011/09/22/create-github-page.html" target="_blank">在github上建立pages的过程</a></li>
  <li>关于jekyll静态网站的介绍，请看我翻译的<a href="http://chen.yanping.me/cn/blog/2011/12/15/building-static-sites-with-jekyll/" target="_blank">文章</a></li>
  <li><a href="http://www.soimort.org/tech-blog/2011/11/19/introduction-to-jekyll_zh.html" target="_blank">像黑客一样写博客——Jekyll入门</a></li>
</ul>

<p>其他技巧：</p>

<ul>
  <li><a href="http://www.pizn.me/2012/01/16/the-seo-for-jekyll-blog.html" target="_blank">优化Jekyll站点的SEO技巧</a></li>
  <li><a href="http://www.pizn.me/2012/02/23/use-category-plugin-for-jekyll-blog.html" target="_blank">为Jekyll博客添加category 分类</a></li>
  <li><a href="http://www.pizn.me/2012/03/01/some-tips-for-jekyll-blog.html" target="_blank">搭建Jekyll博客的一些小技巧</a></li>
</ul>

<p id="code"><strong>六、关于代码高亮</strong>（如果你不贴代码，请跳过这步）</p>

<ul>
  <li>用js插件：<a href="http://mihai.bazon.net/projects/javascript-syntax-highlighting-engine" target="_blank">DlHightLight</a>或<a href="http://code.google.com/p/google-code-prettify/" target="_blank">Google Code Prettify</a></li>
  <li>用<a href="https://gist.github.com/" target="_blank">gist</a>：强烈推荐菜鸟使用，省心省事，支持语言多</li>
  <li>用<a href="http://pygments.org" target="_blank">pygment</a>：要安装python以及python的包管理软件，又是个大坑，不建议菜鸟使用，尤其是使用windows的</li>
</ul>

<p id="latex"><strong>七、关于公式</strong>（如果你不贴公式，请跳过）</p>

<ul>
  <li>使用maruku来解析markdown文件，可以把LaTeX解析成图片，优点是网页加载速度快。但是在windows下安装复杂，且需要安装有LaTeX</li>
  <li><a href="http://www.mathjax.org/" target="_blank">Mathjax</a>，请看我博文的<a href="http://chen.yanping.me/cn/blog/2012/03/10/octopress-with-latex/" target="_blank">介绍</a>，缺点是动态加载，速度慢。</li>
</ul>

<p id="comment"><strong>八、评论</strong></p>

<p>国外的<a href="http://disqus.com" target="_blank">Disqus</a>和国内的<a href="http://uyan.cc/" target="_blank">友言</a></p>

<p>其他社会化服务</p>

<ul>
  <li>分享：国内的<a href="http://jiathis.com" target="_blank">jiathis</a>和国外的<a href="http://addthis.com" target="_blank">addthis</a></li>
  <li>图片：国内的<a href="http://www.yupoo.com/" target="_blank">yupoo</a> 、<a href="http://www.poco.cn/" target="_blank">poco</a>，国外的<a href="http://www.flickr.com/" target="_blank">Flickr</a>、<a href="http://imgur.com" target="_blank">imgur</a></li>
</ul>

<p id="domain"><strong>九、关于域名</strong></p>

<p>在本地代码库里新建名为CNAME的文本文件，把域名地址放进去。假设你的域名是domain.com，可以用命令</p>

<pre><code>echo 'domain.com' &gt; CNAME
</code></pre>

<p>然后</p>

<pre><code>git add CNAME
git commit -am "CNAME file added"
git push
</code></pre>

<p>接着在自己的域名注册商那里改一下指向就行了。如果想对github域名绑定的机制有更多的了解，请看我的三篇博文:<a href="http://chen.yanping.me/cn/blog/2011/12/04/github-pages-domain/" target="_blank">文1</a>，<a href="http://chen.yanping.me/cn/blog/2011/12/26/github-pages-domain-2/" target="_blank">文2</a>和<a href="http://chen.yanping.me/cn/blog/2012/02/06/github-pages-domain-3/" target="_blank">文3</a></p>

<p><strong>十、其他可供选择的模板</strong>，推荐两款比较好用的</p>

<ul>
  <li><a href="http://www.octopress.org">Octopress</a>：windows下的<a href="http://sinosmond.github.com/blog/2012/03/12/install-and-deploy-octopress-to-github-on-windows7-from-scratch/" target="_blank">教程1</a>、<a href="http://tonytonyjan.heroku.com/2012/03/01/install-octopress-on-windows/" target="_blank">教程2</a>，<a href="http://www.yangzhiping.com/tech/octopress.html" target="_blank">ubuntu下的教程</a></li>
  <li><a href="http://jekyllbootstrap.com/" target="_blank">Jekyll Bootstrap</a></li>
</ul>

<p><strong>十一、常犯的错误</strong></p>

<ul>
  <li>明明要给是要做项目主页，却在master分支下上传页面。只有名为username.github.com的是个人主代码库，username是你的github用户名，向这个代码库推送的网页默认的是master分支，直接就可以浏览。其他代码库都是项目代码库</li>
  <li>clone别人的代码库到本地后，没有把它的.git目录删除</li>
  <li>没有把别人页面里的配置部分彻底改掉，比如disqus的配置，CNAME文件，<code>&lt;title&gt;</code>等</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[黑魔法利器pandoc]]></title>
    <link href="http://yanping.me/cn/blog/2012/03/13/pandoc/"/>
    <updated>2012-03-13T00:30:00+08:00</updated>
    <id>http://yanping.me/cn/blog/2012/03/13/pandoc</id>
    <content type="html"><![CDATA[<h2 id="pandoc">pandoc是什么？</h2>

<p>如果你需要把文件从一种标记语言格式转换到另一种格式，<a href="http://johnmacfarlane.net/pandoc" target="_blank">pandoc</a>会是你的瑞士军刀。它可以把<a href="http://daringfireball.net/projects/markdown/">markdown</a>、 <a href="http://docutils.sourceforge.net/docs/ref/rst/introduction.html">reStructuredText</a>、 <a href="http://redcloth.org/textile">textile</a>、 <a href="http://www.w3.org/TR/html40/">HTML</a>、或者<a href="http://www.latex-project.org/">LaTeX</a>转换成：</p>

<ul>
<li>HTML格式: XHTML, HTML5, 以及HTML幻灯片<a href="http://www.w3.org/Talks/Tools/Slidy">Slidy</a>， <a href="http://meyerweb.com/eric/tools/s5/">S5</a>，或者<a href="http://paulrouget.com/dzslides/">DZSlides</a>.</li>
<li>文字处理软件格式： Microsoft Word <a href="http://www.microsoft.com/interop/openup/openxml/default.aspx">docx</a>, OpenOffice/LibreOffice <a href="http://en.wikipedia.org/wiki/OpenDocument">ODT</a>, <a href="http://opendocument.xml.org/">OpenDocument XML</a></li>
<li>电子书： <a href="http://en.wikipedia.org/wiki/EPUB">EPUB</a></li>
<li>文档格式： <a href="http://www.docbook.org/">DocBook</a>, <a href="http://www.gnu.org/software/texinfo/">GNU TexInfo</a>, <a href="http://www.gnu.org/software/groff/groff.html">Groff man</a> pages</li>
<li>TeX格式： <a href="http://www.latex-project.org/">LaTeX</a>, <a href="http://www.pragma-ade.nl/">ConTeXt</a>, LaTeX Beamer slides</li>
<li><a href="http://en.wikipedia.org/wiki/Portable_Document_Format">PDF</a> via LaTeX</li>
<li>轻量级标记语言格式： <a href="http://daringfireball.net/projects/markdown/">Markdown</a>, <a href="http://docutils.sourceforge.net/docs/ref/rst/introduction.html">reStructuredText</a>, <a href="http://www.methods.co.nz/asciidoc/">AsciiDoc</a>, <a href="http://www.mediawiki.org/wiki/Help:Formatting">MediaWiki markup</a>, Emacs <a href="http://orgmode.org">Org-Mode</a>, <a href="http://redcloth.org/textile">Textile</a></li>
</ul>

<!--more-->

<h2 id="section">如何安装</h2>
<p>见<a href="http://johnmacfarlane.net/pandoc/installing.html" target="_blank">http://johnmacfarlane.net/pandoc/installing.html</a>。</p>

<p>需要注意的是，我在ubuntu下用命令<code>sudo apt-get install pandoc</code>安装<a href="http://johnmacfarlane.net/pandoc" target="_blank">pandoc</a>，发现并不能编译beamer</p>

<pre><code>pandoc -t beamer talk.txt -o talk.pdf
pandoc: Unknown writer: beamer
</code></pre>

<p>后来在ubuntu的问答网站发现了<a href="http://askubuntu.com/questions/108138/pandoc-on-ubuntu-cant-use-beamer" target="_blank">答案</a></p>

<pre><code>sudo apt-get autoremove pandoc
sudo apt-get install cabal-install
cabal update
cabal install pandoc
</code></pre>

<p>然后再把<code>~/.cabal</code>加到路径中去，在<code>.bashrc</code>里加上一句</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span /></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span>/home/ypchen/.cabal/bin:<span class="nv">$PATH</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="section-1">怎么用？</h2>

<p>在官方网站的<a href="http://johnmacfarlane.net/pandoc/demos.html" target="_blank">示例</a>中找了一个例子，修改了模板文件<a href="http://yanping.me/cn/downloads/code/2012/03/mytemplate.tex" target="_blank">mytemplate.tex</a>，使它可以支持中文，然后用下面的命令编译<a href="http://yanping.me/cn/downloads/code/2012/03/SLIDES.md" target="_blank">SLIDES.md</a></p>

<pre><code>pandoc -N --template=mytemplate.tex --variable version=1.9 SLIDES.md --latex-engine=xelatex --toc -o example14.pdf
</code></pre>

<p><a href="http://johnmacfarlane.net/pandoc/demos.html" target="_blank">示例</a>页里还有很多别的例子，其中将markdown文件转换成网页的sldes非常吸引人</p>

<div class="showbox">
  <p>pandoc -s –mathml -i -t dzslides <a href="http://johnmacfarlane.net/pandoc/demo/SLIDES" target="_blank">SLIDES</a> -o <a href="http://johnmacfarlane.net/pandoc/demo/example14a.html" target="_blank">example14a.html</a><br />
pandoc -s –webtex -i -t slidy <a href="http://johnmacfarlane.net/pandoc/demo/SLIDES" target="_blank">SLIDES</a> -o <a href="http://johnmacfarlane.net/pandoc/demo/example14b.html" target="_blank">example14b.html</a><br />
pandoc -s –webtex -t -t s5 <a href="http://johnmacfarlane.net/pandoc/demo/SLIDES" target="_blank">SLIDES</a> -o <a href="http://johnmacfarlane.net/pandoc/demo/example14c.html" target="_blank">example14c.html</a></p>
</div>

<p>之前益辉就给出过一个<a href="http://yihui.name/cn/2011/11/html5-slides/" target="_blank">HTML5幻灯片的例子</a>。人生苦短啊，不要把太多的时间和精力浪费在调格式上了。</p>

<h3 id="section-2">参考文章</h3>
<ul>
  <li><a href="http://stdio.tumblr.com/lightdoc" target="_blank">pandoc介绍</a></li>
  <li><a href="http://sysadvent.blogspot.com/2011/12/day-14-write-your-resume-in-markdown.html" target="_blank">如何用markdown写简历</a></li>
  <li><a href="http://www.music.mcgill.ca/~sinclair/content/blog/using_markdown_for_beamer_presentations" target="_blank">如何用markdown写beamer幻灯片</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[我的Octopress样式表]]></title>
    <link href="http://yanping.me/cn/blog/2012/03/12/my-style-list/"/>
    <updated>2012-03-12T22:16:00+08:00</updated>
    <id>http://yanping.me/cn/blog/2012/03/12/my-style-list</id>
    <content type="html"><![CDATA[<p><code>/sass/custom/_styles.scss</code>里是用户自己定义的样式，我在博客里添加了表格、脚注、提示框等样式，本文作为备忘，博客每次更新本文会自动更新，这也是用octopress博客的好处，我不过是在博客里插入下面两段代码：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class=""><span class="line">{% codeblock (/sass/custom/_styles.scss) %}
</span><span class="line">	{% render_partial ../sass/custom/_styles.scss raw%}
</span><span class="line">{% endcodeblock %}</span></code></pre></td></tr></table></div></figure></notextile></div>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class=""><span class="line">{% codeblock (/sass/custom/_fonts.scss) %}
</span><span class="line">	{% render_partial ../sass/custom/_fonts.scss raw%}
</span><span class="line">{% endcodeblock %}</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>由于本人刚刚学习CSS，所以写的东西难免幼稚，也可能有错的地方，请各位看官多提宝贵意见。</p>

<p>关于sass和scss，请参考<a href="http://blog.visioncan.com/2011/sass-scss-your-css/" target="_blank">《使用scss來加速寫css吧!》</a>和<a href="http://blog.visioncan.com/2011/compass-sass-your-css/" target="_blank">《用強大的compass+sass寫css》</a></p>

<!--more-->

<h2 id="section">自定义样式</h2>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>(/sass/custom/_styles.scss) </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
<span class="line-number">38</span>
<span class="line-number">39</span>
<span class="line-number">40</span>
<span class="line-number">41</span>
<span class="line-number">42</span>
<span class="line-number">43</span>
<span class="line-number">44</span>
<span class="line-number">45</span>
<span class="line-number">46</span>
<span class="line-number">47</span>
<span class="line-number">48</span>
<span class="line-number">49</span>
<span class="line-number">50</span>
<span class="line-number">51</span>
<span class="line-number">52</span>
<span class="line-number">53</span>
<span class="line-number">54</span>
<span class="line-number">55</span>
<span class="line-number">56</span>
<span class="line-number">57</span>
<span class="line-number">58</span>
<span class="line-number">59</span>
<span class="line-number">60</span>
<span class="line-number">61</span>
<span class="line-number">62</span>
<span class="line-number">63</span>
<span class="line-number">64</span>
<span class="line-number">65</span>
<span class="line-number">66</span>
<span class="line-number">67</span>
<span class="line-number">68</span>
<span class="line-number">69</span>
<span class="line-number">70</span>
<span class="line-number">71</span>
<span class="line-number">72</span>
<span class="line-number">73</span>
<span class="line-number">74</span>
<span class="line-number">75</span>
<span class="line-number">76</span>
<span class="line-number">77</span>
<span class="line-number">78</span>
<span class="line-number">79</span>
<span class="line-number">80</span>
<span class="line-number">81</span>
<span class="line-number">82</span>
<span class="line-number">83</span>
<span class="line-number">84</span>
<span class="line-number">85</span>
<span class="line-number">86</span>
<span class="line-number">87</span>
<span class="line-number">88</span>
<span class="line-number">89</span>
<span class="line-number">90</span>
<span class="line-number">91</span>
<span class="line-number">92</span>
<span class="line-number">93</span>
<span class="line-number">94</span>
<span class="line-number">95</span>
<span class="line-number">96</span>
<span class="line-number">97</span>
<span class="line-number">98</span>
<span class="line-number">99</span>
<span class="line-number">100</span>
<span class="line-number">101</span>
<span class="line-number">102</span>
<span class="line-number">103</span>
<span class="line-number">104</span>
<span class="line-number">105</span>
<span class="line-number">106</span>
<span class="line-number">107</span>
<span class="line-number">108</span>
<span class="line-number">109</span>
<span class="line-number">110</span>
<span class="line-number">111</span>
<span class="line-number">112</span>
<span class="line-number">113</span>
<span class="line-number">114</span>
<span class="line-number">115</span>
<span class="line-number">116</span>
<span class="line-number">117</span>
<span class="line-number">118</span>
<span class="line-number">119</span>
<span class="line-number">120</span>
<span class="line-number">121</span>
<span class="line-number">122</span>
<span class="line-number">123</span>
<span class="line-number">124</span>
<span class="line-number">125</span>
<span class="line-number">126</span>
<span class="line-number">127</span>
<span class="line-number">128</span>
<span class="line-number">129</span>
<span class="line-number">130</span>
<span class="line-number">131</span>
<span class="line-number">132</span>
<span class="line-number">133</span>
<span class="line-number">134</span>
<span class="line-number">135</span>
<span class="line-number">136</span>
<span class="line-number">137</span>
<span class="line-number">138</span>
<span class="line-number">139</span>
<span class="line-number">140</span>
<span class="line-number">141</span>
<span class="line-number">142</span>
<span class="line-number">143</span>
<span class="line-number">144</span>
<span class="line-number">145</span>
<span class="line-number">146</span>
<span class="line-number">147</span>
<span class="line-number">148</span>
<span class="line-number">149</span>
<span class="line-number">150</span>
<span class="line-number">151</span>
<span class="line-number">152</span>
<span class="line-number">153</span>
<span class="line-number">154</span>
<span class="line-number">155</span>
<span class="line-number">156</span>
<span class="line-number">157</span>
<span class="line-number">158</span>
<span class="line-number">159</span>
<span class="line-number">160</span>
<span class="line-number">161</span>
<span class="line-number">162</span>
<span class="line-number">163</span>
<span class="line-number">164</span>
<span class="line-number">165</span>
<span class="line-number">166</span>
<span class="line-number">167</span>
<span class="line-number">168</span>
</pre></td><td class="code"><pre><code class="scss"><span class="line"><span class="c1">// This File is imported last, and will override other styles in the cascade</span>
</span><span class="line"><span class="c1">// Add styles here to make changes without digging in too much</span>
</span><span class="line">
</span><span class="line"><span class="cm">/* 自定义的样式 */</span>
</span><span class="line"><span class="nt">p</span><span class="o">,</span><span class="nt">blockquote</span><span class="o">,</span><span class="nt">ul</span><span class="o">,</span><span class="nt">ol</span><span class="p">{</span><span class="na">margin-bottom</span><span class="o">:</span> <span class="mi">0</span><span class="mf">.618</span><span class="kt">em</span><span class="p">}</span>  <span class="cm">/* 调整行距*/</span>
</span><span class="line">
</span><span class="line"><span class="k">@media</span> <span class="nt">only</span> <span class="nt">screen</span> <span class="nt">and</span> <span class="o">(</span><span class="nt">min-width</span><span class="nd">:992px</span><span class="o">)</span> <span class="p">{</span>
</span><span class="line"><span class="nt">h1</span> <span class="p">{</span>
</span><span class="line">    <span class="na">font-size</span><span class="o">:</span><span class="mi">2</span><span class="mf">.2</span><span class="kt">em</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="nt">blockquote</span><span class="p">{</span>
</span><span class="line">	<span class="nt">font-family</span><span class="nd">:Arial</span><span class="o">,</span> <span class="err">楷体</span><span class="nt">_GB2312</span><span class="o">,</span> <span class="nt">sans-serif</span><span class="o">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="cm">/* 提示框样式 */</span>
</span><span class="line">
</span><span class="line"><span class="nc">.info</span><span class="o">,</span> <span class="nc">.warning</span><span class="p">{</span>
</span><span class="line">
</span><span class="line">	<span class="nt">border</span><span class="nd">:none</span><span class="o">;</span>
</span><span class="line">	<span class="nt">padding</span><span class="nd">:0</span><span class="nc">.6em</span> <span class="nt">1</span><span class="nc">.25em</span> <span class="nt">0</span><span class="nc">.6em</span> <span class="nt">48px</span><span class="o">;</span>
</span><span class="line">	<span class="nt">margin-top</span><span class="nd">:0</span><span class="nc">.25em</span><span class="o">;</span>
</span><span class="line">
</span><span class="line">	<span class="nt">-webkit-border-radius</span><span class="nd">:</span> <span class="nt">8px</span><span class="o">;</span>
</span><span class="line">	<span class="nt">-moz-border-radius</span><span class="nd">:</span> <span class="nt">8px</span><span class="o">;</span>
</span><span class="line">	<span class="nt">border-radius</span><span class="nd">:</span> <span class="nt">8px</span><span class="o">;</span>
</span><span class="line">	
</span><span class="line">	<span class="nt">-webkit-box-shadow</span><span class="nd">:</span> <span class="nt">0</span> <span class="nt">4px</span> <span class="nt">4px</span> <span class="nt">rgba</span><span class="o">(</span><span class="nt">0</span><span class="o">,</span> <span class="nt">0</span><span class="o">,</span> <span class="nt">0</span><span class="o">,</span> <span class="nt">0</span><span class="nc">.3</span><span class="o">);</span>
</span><span class="line">	<span class="nt">-moz-box-shadow</span><span class="nd">:</span> <span class="nt">0</span> <span class="nt">4px</span> <span class="nt">4px</span> <span class="nt">rgba</span><span class="o">(</span><span class="nt">0</span><span class="o">,</span> <span class="nt">0</span><span class="o">,</span> <span class="nt">0</span><span class="o">,</span> <span class="nt">0</span><span class="nc">.3</span><span class="o">);</span>
</span><span class="line">	<span class="nt">-box-shadow</span><span class="nd">:</span> <span class="nt">0</span> <span class="nt">4px</span> <span class="nt">4px</span> <span class="nt">rgba</span><span class="o">(</span><span class="nt">0</span><span class="o">,</span> <span class="nt">0</span><span class="o">,</span> <span class="nt">0</span><span class="o">,</span> <span class="nt">0</span><span class="nc">.3</span><span class="o">);</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="nc">.info</span><span class="p">{</span>
</span><span class="line">	<span class="na">background</span><span class="o">:</span><span class="mh">#d5e9f6</span> <span class="sx">url(/cn/images/blog/tab_info.gif)</span> <span class="no">no-repeat</span> <span class="no">left</span> <span class="no">top</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="nc">.warning</span><span class="p">{</span>
</span><span class="line">	<span class="na">background</span><span class="o">:</span><span class="mh">#f9d9d8</span> <span class="sx">url(/cn/images/blog/tab_red.gif)</span> <span class="no">no-repeat</span> <span class="no">left</span> <span class="no">top</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="cm">/* -----表格样式----- */</span>
</span><span class="line">
</span><span class="line"><span class="nc">.datalist</span><span class="p">{</span>
</span><span class="line">    <span class="na">border</span><span class="o">:</span><span class="mi">1</span><span class="kt">px</span> <span class="no">solid</span> <span class="mh">#007eff</span><span class="p">;</span>
</span><span class="line">    <span class="nt">border-collapse</span><span class="nd">:collapse</span><span class="o">;</span>
</span><span class="line">	<span class="nt">margin</span><span class="nd">:</span> <span class="nt">20px</span> <span class="nt">auto</span> <span class="nt">20px</span> <span class="nt">auto</span><span class="o">;</span>
</span><span class="line">	
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="nc">.datalist</span> <span class="nt">caption</span><span class="p">{</span>
</span><span class="line">	<span class="nt">font-weight</span><span class="nd">:bold</span><span class="o">;</span>
</span><span class="line">	<span class="nt">text-align</span><span class="nd">:center</span><span class="o">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="nc">.datalist</span> <span class="nt">th</span><span class="p">{</span>
</span><span class="line">    <span class="na">border</span><span class="o">:</span><span class="mi">1</span><span class="kt">px</span> <span class="no">solid</span> <span class="mh">#429fff</span><span class="p">;</span>
</span><span class="line">    <span class="na">background-color</span><span class="o">:</span><span class="mh">#d2e8ff</span><span class="p">;</span>
</span><span class="line">    <span class="nt">font-weight</span><span class="nd">:bold</span><span class="o">;</span>
</span><span class="line">    <span class="nt">padding-top</span><span class="nd">:4px</span><span class="o">;</span>
</span><span class="line">    <span class="nt">padding-bottom</span><span class="nd">:4px</span><span class="o">;</span>
</span><span class="line">    <span class="nt">padding-left</span><span class="nd">:10px</span><span class="o">;</span>
</span><span class="line">    <span class="nt">padding-right</span><span class="nd">:10px</span><span class="o">;</span>
</span><span class="line">    <span class="nt">text-align</span><span class="nd">:center</span><span class="o">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="nc">.datalist</span> <span class="nt">td</span><span class="p">{</span>
</span><span class="line">      <span class="na">border</span><span class="o">:</span><span class="mi">1</span><span class="kt">px</span> <span class="no">solid</span> <span class="mh">#429fff</span><span class="p">;</span>
</span><span class="line">      <span class="nt">text-align</span><span class="nd">:left</span><span class="o">;</span>
</span><span class="line">      <span class="nt">padding</span><span class="nd">:4px</span><span class="o">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="nc">.datalist</span> <span class="nt">tr</span><span class="nd">:hover</span><span class="p">{</span>
</span><span class="line">    <span class="na">background-color</span><span class="o">:</span><span class="mh">#c4e4fe</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="cm">/* -------------- */</span>
</span><span class="line">
</span><span class="line"><span class="nc">.none-left-margin</span><span class="p">{</span>
</span><span class="line">    <span class="na">padding-left</span><span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="cm">/* -----侧边栏样式----- */</span>
</span><span class="line">
</span><span class="line"><span class="nc">.blogroll</span> <span class="nt">a</span><span class="p">{</span>
</span><span class="line">    <span class="nt">text-decoration</span><span class="nd">:none</span><span class="o">;</span>
</span><span class="line">
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="nn">#recent_posts</span> <span class="nt">a</span><span class="p">{</span>
</span><span class="line">    <span class="nt">text-decoration</span><span class="nd">:none</span><span class="o">;</span>
</span><span class="line">
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="nn">#copyleft</span> <span class="nt">a</span><span class="p">{</span>
</span><span class="line">    <span class="nt">text-decoration</span><span class="nd">:none</span><span class="o">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="nn">#comment_sidebar</span> <span class="nt">a</span><span class="p">{</span>
</span><span class="line">    <span class="nt">text-decoration</span><span class="nd">:none</span><span class="o">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="nn">#comment_sidebar</span> <span class="nt">ul</span><span class="p">{</span>
</span><span class="line">    <span class="na">padding-left</span><span class="o">:</span><span class="mi">0</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="nn">#categories_tag</span> <span class="nt">a</span><span class="p">{</span>
</span><span class="line">    <span class="nt">text-decoration</span><span class="nd">:none</span><span class="o">;</span>
</span><span class="line">
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="cm">/*--- 关于脚注 ---*/</span>
</span><span class="line"><span class="nt">div</span><span class="nc">.footnotes</span><span class="p">{</span>
</span><span class="line">	<span class="na">border-top</span><span class="o">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="no">dashed</span> <span class="n">grey</span><span class="p">;</span>
</span><span class="line">	<span class="na">font-size</span><span class="o">:</span> <span class="mi">0</span><span class="mf">.8</span><span class="kt">em</span><span class="p">;</span>
</span><span class="line">	
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="nt">div</span><span class="nc">.footnotes</span> <span class="o">&gt;</span> <span class="nt">ol</span><span class="nd">:before</span><span class="p">{</span>
</span><span class="line">	<span class="na">margin-left</span><span class="o">:</span> <span class="mi">-20</span><span class="kt">px</span><span class="p">;</span>
</span><span class="line">	<span class="na">content</span><span class="o">:</span> <span class="s2">&quot;脚注： &quot;</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="nc">.footnotes</span> <span class="nt">blockquote</span><span class="p">{</span>
</span><span class="line">	<span class="na">font-size</span><span class="o">:</span> <span class="mi">0</span><span class="mf">.8</span><span class="kt">em</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="nt">a</span><span class="o">[</span><span class="nt">rel</span><span class="o">=</span><span class="s2">&quot;footnote&quot;</span><span class="o">]</span><span class="nd">:after</span><span class="p">{</span>
</span><span class="line">	<span class="na">content</span><span class="o">:</span> <span class="s2">&quot;]&quot;</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="nt">a</span><span class="o">[</span><span class="nt">rel</span><span class="o">=</span><span class="s2">&quot;footnote&quot;</span><span class="o">]</span><span class="nd">:before</span><span class="p">{</span>
</span><span class="line">	<span class="na">content</span><span class="o">:</span> <span class="s2">&quot;[&quot;</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="nt">a</span><span class="o">[</span><span class="nt">rev</span><span class="o">=</span><span class="s2">&quot;footnote&quot;</span><span class="o">]</span><span class="nd">:after</span><span class="p">{</span>
</span><span class="line">	<span class="na">content</span><span class="o">:</span> <span class="s2">&quot;]&quot;</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="nt">a</span><span class="o">[</span><span class="nt">rev</span><span class="o">=</span><span class="s2">&quot;footnote&quot;</span><span class="o">]</span><span class="nd">:before</span><span class="p">{</span>
</span><span class="line">	<span class="na">content</span><span class="o">:</span> <span class="s2">&quot;[&quot;</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="cm">/*--- 关于脚注结束 ---*/</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="nt">pre</span> <span class="nt">code</span><span class="p">{</span>
</span><span class="line">	<span class="na">color</span><span class="o">:</span><span class="mh">#DDD</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="nt">div</span><span class="nc">.showbox</span><span class="p">{</span>
</span><span class="line">	<span class="na">margin</span><span class="o">:</span> <span class="mi">15</span><span class="kt">px</span> <span class="no">auto</span> <span class="mi">15</span><span class="kt">px</span> <span class="no">auto</span><span class="p">;</span>
</span><span class="line">	<span class="na">background-color</span><span class="o">:</span> <span class="nb">white</span><span class="p">;</span>
</span><span class="line">	<span class="na">border</span><span class="o">:</span> <span class="no">solid</span> <span class="mi">1</span><span class="kt">px</span> <span class="nb">black</span><span class="p">;</span>
</span><span class="line">	<span class="na">padding</span><span class="o">:</span> <span class="mi">10</span><span class="kt">px</span> <span class="mi">10</span><span class="kt">px</span> <span class="mi">5</span><span class="kt">px</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
</span><span class="line">
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="nt">div</span><span class="nc">.sharing</span><span class="p">{</span>
</span><span class="line">	<span class="na">margin-bottom</span><span class="o">:</span> <span class="mi">25</span><span class="kt">px</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="section-1">自定义字体样式</h2>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>(/sass/custom/_styles.scss) </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
</pre></td><td class="code"><pre><code class="scss"><span class="line"><span class="c1">// Here you can easily change font faces which are used in your site.</span>
</span><span class="line"><span class="c1">// To give it a try, uncomment some of the lines below rebuild your blog, and see how it works. your sites&#39;s.</span>
</span><span class="line"><span class="c1">// If you love to use Web Fonts, you also need to add some lines to source/_includes/custom/head.html</span>
</span><span class="line">
</span><span class="line"><span class="nv">$sans</span><span class="o">:</span> <span class="n">Palatino</span><span class="o">,</span> <span class="s2">&quot;Palatino Linotype&quot;</span><span class="o">,</span> <span class="n">Georgia</span><span class="err">，</span> <span class="s2">&quot;Hiragino Sans GB&quot;</span><span class="o">,</span> <span class="s2">&quot;文泉驿微米黑&quot;</span><span class="o">,</span> <span class="s2">&quot;Microsoft YaHei&quot;</span><span class="o">,</span><span class="s2">&quot;SimSun&quot;</span><span class="o">,</span> <span class="no">sans-serif</span><span class="p">;</span>
</span><span class="line"><span class="nv">$serif</span><span class="o">:</span> <span class="s2">&quot;Baskerville&quot;</span><span class="o">,</span> <span class="s2">&quot;文泉驿微米黑&quot;</span><span class="o">,</span> <span class="no">serif</span><span class="p">;</span>
</span><span class="line"><span class="c1">//$mono:&quot;PT mono&quot;, &quot;Courier&quot;, &quot;文泉驿微米黑&quot;, &quot;Microsoft YaHei&quot;, monospace;</span>
</span><span class="line"><span class="na">$heading-font-family</span><span class="o">:</span> <span class="s2">&quot;Verdana&quot;</span><span class="o">,</span> <span class="err">楷体</span><span class="n">_GB2312</span><span class="o">,</span> <span class="no">sans-serif</span><span class="p">;</span>
</span><span class="line"><span class="na">$header-title-font-family</span><span class="o">:</span> <span class="s2">&quot;Futura&quot;</span><span class="o">,</span> <span class="no">sans-serif</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

]]></content>
  </entry>
  
</feed>
